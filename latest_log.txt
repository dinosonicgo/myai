### AI Lover Log - Last updated at 2025-09-30T23:26:44.297672 ###

    return await retry_target(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\retry\retry_unary_async.py", line 163, in retry_target
    next_sleep = _retry_error_helper(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\retry\retry_unary_async.py", line 158, in retry_target
    return await target()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits.
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_input_token_count, limit: 250000
Please retry in 52.710697979s. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash-lite"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 250000
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 52
}
]
2025-09-30 23:12:09 - [ERROR] - [512280345618546699] Key #3 (模型: gemini-2.5-flash-lite) 在 3 次內部重試後仍然失敗 (ResourceExhausted)。將輪換到下一個金鑰並觸發持久化冷卻。
2025-09-30 23:12:10 - [WARNING] - [512280345618546699] Key #4 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 1.36 秒後進行第 2 次嘗試...
2025-09-30 23:12:14 - [WARNING] - [512280345618546699] Key #4 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 2.32 秒後進行第 3 次嘗試...
2025-09-30 23:15:31 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-30 23:15:31 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-30 23:15:31 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-30 23:15:31 - [INFO] - Discord Bot is ready!
2025-09-30 23:15:34 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-30 23:15:34 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-30 23:15:34 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-30 23:15:49 - [INFO] - [512280345618546699] 後台重置任務開始...
2025-09-30 23:15:49 - [INFO] - [512280345618546699] 未檢測到活躍的 AI 實例，直接進行清理。
2025-09-30 23:15:49 - [INFO] - [512280345618546699] 正在清除所有資料庫記錄...
2025-09-30 23:15:50 - [INFO] - [512280345618546699] 所有資料庫記錄已成功清除。
2025-09-30 23:15:50 - [INFO] - [512280345618546699] (Robust Delete) 正在啟動對目錄 data\vector_stores\512280345618546699 的健壯刪除流程...
2025-09-30 23:15:50 - [INFO] - [512280345618546699] (Robust Delete) ✅ 在第 1 次嘗試中成功刪除目錄: data\vector_stores\512280345618546699
2025-09-30 23:15:51 - [INFO] - [512280345618546699] (UI Event) Persistent 'StartSetupView' button clicked.
2025-09-30 23:15:56 - [INFO] - [512280345618546699] (UI Event) WorldSettingsModal submitted. is_setup_flow: True
2025-09-30 23:15:56 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-09-30 23:15:56 - [INFO] - [512280345618546699] 處於設定流程中，即使資料庫無記錄，也創建一個臨時的記憶體實例。
2025-09-30 23:15:56 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-09-30 23:15:56 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-09-30 23:15:56 - [INFO] - [512280345618546699] 正在創建本地 Embedding 模型 'infgrad/stella-base-zh-v2' 實例...
2025-09-30 23:15:59 - [INFO] - [512280345618546699] ✅ 本地 Embedding 模型實例創建成功。
2025-09-30 23:15:59 - [INFO] - [512280345618546699] 所有輕量級前置資源已準備就緒 (RAG 創建已延遲)。
2025-09-30 23:15:59 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['world_settings']
2025-09-30 23:15:59 - [WARNING] - [512280345618546699] 在持久化更新時找不到使用者資料，將創建新記錄。
2025-09-30 23:16:00 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 23:16:02 - [INFO] - [512280345618546699] (UI Event) Persistent 'ContinueToUserSetupView' button clicked.
2025-09-30 23:16:10 - [INFO] - [512280345618546699] (UI Event) CharacterSettingsModal submitted for profile_type: 'user', is_setup_flow: True
2025-09-30 23:16:11 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['user_profile']
2025-09-30 23:16:11 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 23:17:02 - [INFO] - [512280345618546699] (UI Event) Persistent 'ContinueToAiSetupView' button clicked.
2025-09-30 23:17:14 - [INFO] - [512280345618546699] (UI Event) CharacterSettingsModal submitted for profile_type: 'ai', is_setup_flow: True
2025-09-30 23:17:14 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['ai_profile']
2025-09-30 23:17:14 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 23:17:16 - [INFO] - [512280345618546699] [創世流程] 檔案上傳開始，已設定 active_setups 狀態鎖。
2025-09-30 23:17:21 - [INFO] - [512280345618546699] (on_message) 偵測到用戶處於活躍的創世流程中，已忽略常規訊息 '...' 以防止競爭。
2025-09-30 23:17:24 - [INFO] - [512280345618546699] 獨立的後台創世流程已為用戶啟動。
2025-09-30 23:17:24 - [INFO] - [512280345618546699] [後台創世 1/6] 正在強制清理並創建一個空的 RAG 索引...
2025-09-30 23:17:24 - [INFO] - [512280345618546699] [資源管理] 正在釋放 RAG 資源...
2025-09-30 23:17:24 - [INFO] - [512280345618546699] [資源管理] RAG 資源已成功釋放。
2025-09-30 23:17:24 - [INFO] - [512280345618546699] (Retriever Builder) 強制重建觸發，正在從資料庫執行全量創始構建...
2025-09-30 23:17:24 - [INFO] - [512280345618546699] (Retriever Builder) 執行強制清理，正在刪除舊的向量儲存目錄...
2025-09-30 23:17:24 - [INFO] - [512280345618546699] (Retriever Builder) 已確保向量儲存目錄為全新狀態。
2025-09-30 23:17:24 - [INFO] - [512280345618546699] (Retriever Builder) 已從 SQL 和 LORE 加載 0 條文檔用於創始構建。
2025-09-30 23:17:33 - [INFO] - [512280345618546699] (Retriever Builder) 知識庫為空，已使用手動初始化的 Client 創建一個空的 RAG 系統。
2025-09-30 23:17:33 - [INFO] - [512280345618546699] [後台創世 1/6] 空的 RAG 容器已準備就緒。
2025-09-30 23:17:33 - [INFO] - [512280345618546699] [後台創世 2/6] 正在將世界聖經原文填充進 RAG 索引...
2025-09-30 23:17:33 - [INFO] - [512280345618546699] (Canon Processor) 正在將 34 個世界聖經文本塊添加到 RAG 索引...
2025-09-30 23:18:09 - [INFO] - [512280345618546699] (Canon Processor) ✅ 世界聖經已成功添加到 ChromaDB。
2025-09-30 23:18:09 - [INFO] - [512280345618546699] [後台創世 2/6] RAG 索引填充並重載完成。
2025-09-30 23:18:09 - [INFO] - [512280345618546699] [後台創世 3/6] 正在啟動 RAG 驅動的專職流水線進行 LORE 解析...
2025-09-30 23:18:09 - [INFO] - [512280345618546699] [RAG驱动解析 1/3] 正在使用 LLM 提取并分类所有 LORE 实体...
2025-09-30 23:18:15 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-09-30 23:18:15 - [INFO] - [512280345618546699] [RAG驱动解析 1/3] 成功识别出 81 个 LORE 任务。
2025-09-30 23:18:15 - [INFO] - [512280345618546699] [RAG驱动解析 2/3] 正在按类别分发任务，并【串行】启动所有专职解析流水线以避免速率超限...
2025-09-30 23:18:15 - [INFO] - [512280345618546699] [RAG驱动解析 2/3] 正在串行处理类别: 'npc_profile'...
2025-09-30 23:18:17 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 任务 '提取所有身份、头衔、绰号和别名到 aliases 列表' 已启动...
2025-09-30 23:18:19 - [WARNING] - [512280345618546699] Key #1 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 1.12 秒後進行第 2 次嘗試...
2025-09-30 23:18:21 - [WARNING] - [512280345618546699] Key #1 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 2.30 秒後進行第 3 次嘗試...
2025-09-30 23:18:25 - [ERROR] - [512280345618546699] Key #1 (模型: gemini-2.5-flash-lite) 在 3 次內部重試後仍然失敗 (ResourceExhausted)。將輪換到下一個金鑰並觸發持久化冷卻。
2025-09-30 23:18:26 - [WARNING] - [512280345618546699] Key #2 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 1.39 秒後進行第 2 次嘗試...
2025-09-30 23:18:29 - [WARNING] - [512280345618546699] Key #2 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 2.13 秒後進行第 3 次嘗試...
2025-09-30 23:18:32 - [ERROR] - [512280345618546699] Key #2 (模型: gemini-2.5-flash-lite) 在 3 次內部重試後仍然失敗 (ResourceExhausted)。將輪換到下一個金鑰並觸發持久化冷卻。
2025-09-30 23:18:34 - [WARNING] - [512280345618546699] Key #3 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 1.14 秒後進行第 2 次嘗試...
2025-09-30 23:18:36 - [WARNING] - [512280345618546699] Key #3 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 2.12 秒後進行第 3 次嘗試...
2025-09-30 23:18:40 - [ERROR] - [512280345618546699] Key #3 (模型: gemini-2.5-flash-lite) 在 3 次內部重試後仍然失敗 (ResourceExhausted)。將輪換到下一個金鑰並觸發持久化冷卻。
2025-09-30 23:18:41 - [WARNING] - [512280345618546699] Key #4 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 1.35 秒後進行第 2 次嘗試...
2025-09-30 23:18:44 - [WARNING] - [512280345618546699] Key #4 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 2.21 秒後進行第 3 次嘗試...
2025-09-30 23:18:47 - [ERROR] - [512280345618546699] Key #4 (模型: gemini-2.5-flash-lite) 在 3 次內部重試後仍然失敗 (ResourceExhausted)。將輪換到下一個金鑰並觸發持久化冷卻。
2025-09-30 23:18:49 - [WARNING] - [512280345618546699] Key #5 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 1.27 秒後進行第 2 次嘗試...
2025-09-30 23:18:51 - [WARNING] - [512280345618546699] Key #5 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 2.41 秒後進行第 3 次嘗試...
2025-09-30 23:18:55 - [ERROR] - [512280345618546699] Key #5 (模型: gemini-2.5-flash-lite) 在 3 次內部重試後仍然失敗 (ResourceExhausted)。將輪換到下一個金鑰並觸發持久化冷卻。
2025-09-30 23:18:56 - [WARNING] - [512280345618546699] Key #0 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 1.48 秒後進行第 2 次嘗試...
2025-09-30 23:18:59 - [WARNING] - [512280345618546699] Key #0 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 2.22 秒後進行第 3 次嘗試...
2025-09-30 23:19:03 - [ERROR] - [512280345618546699] Key #0 (模型: gemini-2.5-flash-lite) 在 3 次內部重試後仍然失敗 (ResourceExhausted)。將輪換到下一個金鑰並觸發持久化冷卻。
2025-09-30 23:19:03 - [ERROR] - [512280345618546699] [Final Failure] 所有模型和金鑰均最終失敗。最後的錯誤是: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits.
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_input_token_count, limit: 250000
Please retry in 54.702440643s. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash-lite"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 250000
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 54
}
]
2025-09-30 23:19:03 - [ERROR] - [512280345618546699] [专职流水线 - npc_profile] 🔥 任务 '提取所有身份、头衔、绰号和别名到 aliases 列表' 提取失败: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits.
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_input_token_count, limit: 250000
Please retry in 54.702440643s. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash-lite"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 250000
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 54
}
]
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 808, in run_category_pipeline
    result = await self.ainvoke_with_rotation(full_prompt, output_schema=pydantic_schema, retry_strategy='euphemize')
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 1353, in ainvoke_with_rotation
    raise last_exception if last_exception else Exception("ainvoke_with_rotation failed without a specific exception.")
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 1256, in ainvoke_with_rotation
    response = await asyncio.wait_for(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\generativeai\generative_models.py", line 385, in generate_content_async
    response = await self._async_client.generate_content(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\async_client.py", line 406, in generate_content
    response = await rpc(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\retry\retry_unary_async.py", line 231, in retry_wrapped_func
    return await retry_target(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\retry\retry_unary_async.py", line 163, in retry_target
    next_sleep = _retry_error_helper(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\retry\retry_unary_async.py", line 158, in retry_target
    return await target()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits.
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_input_token_count, limit: 250000
Please retry in 54.702440643s. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash-lite"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 250000
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 54
}
]
2025-09-30 23:19:05 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 任务 '提取所有外观细节到 appearance_details 模型' 已启动...
2025-09-30 23:19:06 - [WARNING] - [512280345618546699] Key #1 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 1.30 秒後進行第 2 次嘗試...
2025-09-30 23:19:09 - [WARNING] - [512280345618546699] Key #1 (模型: gemini-2.5-flash-lite) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 2.20 秒後進行第 3 次嘗試...
2025-09-30 23:21:26 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-30 23:21:26 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-30 23:21:27 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-30 23:21:27 - [INFO] - Discord Bot is ready!
2025-09-30 23:21:30 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-30 23:21:30 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-30 23:21:30 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-30 23:21:38 - [INFO] - [512280345618546699] 後台重置任務開始...
2025-09-30 23:21:38 - [INFO] - [512280345618546699] 未檢測到活躍的 AI 實例，直接進行清理。
2025-09-30 23:21:38 - [INFO] - [512280345618546699] 正在清除所有資料庫記錄...
2025-09-30 23:21:38 - [INFO] - [512280345618546699] 所有資料庫記錄已成功清除。
2025-09-30 23:21:38 - [INFO] - [512280345618546699] (Robust Delete) 正在啟動對目錄 data\vector_stores\512280345618546699 的健壯刪除流程...
2025-09-30 23:21:38 - [INFO] - [512280345618546699] (Robust Delete) ✅ 在第 1 次嘗試中成功刪除目錄: data\vector_stores\512280345618546699
2025-09-30 23:21:53 - [INFO] - [512280345618546699] (UI Event) Persistent 'StartSetupView' button clicked.
2025-09-30 23:21:59 - [INFO] - [512280345618546699] (UI Event) WorldSettingsModal submitted. is_setup_flow: True
2025-09-30 23:21:59 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-09-30 23:21:59 - [INFO] - [512280345618546699] 處於設定流程中，即使資料庫無記錄，也創建一個臨時的記憶體實例。
2025-09-30 23:21:59 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-09-30 23:21:59 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-09-30 23:21:59 - [INFO] - [512280345618546699] 正在創建本地 Embedding 模型 'infgrad/stella-base-zh-v2' 實例...
2025-09-30 23:22:03 - [INFO] - [512280345618546699] ✅ 本地 Embedding 模型實例創建成功。
2025-09-30 23:22:03 - [INFO] - [512280345618546699] 所有輕量級前置資源已準備就緒 (RAG 創建已延遲)。
2025-09-30 23:22:03 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['world_settings']
2025-09-30 23:22:03 - [WARNING] - [512280345618546699] 在持久化更新時找不到使用者資料，將創建新記錄。
2025-09-30 23:22:03 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 23:22:05 - [INFO] - [512280345618546699] (UI Event) Persistent 'ContinueToUserSetupView' button clicked.
2025-09-30 23:22:14 - [INFO] - [512280345618546699] (UI Event) CharacterSettingsModal submitted for profile_type: 'user', is_setup_flow: True
2025-09-30 23:22:14 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['user_profile']
2025-09-30 23:22:15 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 23:22:16 - [INFO] - [512280345618546699] (UI Event) Persistent 'ContinueToAiSetupView' button clicked.
2025-09-30 23:23:02 - [INFO] - [512280345618546699] (UI Event) CharacterSettingsModal submitted for profile_type: 'ai', is_setup_flow: True
2025-09-30 23:23:02 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['ai_profile']
2025-09-30 23:23:04 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 23:23:06 - [INFO] - [512280345618546699] [創世流程] 檔案上傳開始，已設定 active_setups 狀態鎖。
2025-09-30 23:23:11 - [INFO] - [512280345618546699] (on_message) 偵測到用戶處於活躍的創世流程中，已忽略常規訊息 '...' 以防止競爭。
2025-09-30 23:23:13 - [INFO] - [512280345618546699] 獨立的後台創世流程已為用戶啟動。
2025-09-30 23:23:13 - [INFO] - [512280345618546699] [後台創世 1/6] 正在強制清理並創建一個空的 RAG 索引...
2025-09-30 23:23:13 - [INFO] - [512280345618546699] [資源管理] 正在釋放 RAG 資源...
2025-09-30 23:23:13 - [INFO] - [512280345618546699] [資源管理] RAG 資源已成功釋放。
2025-09-30 23:23:13 - [INFO] - [512280345618546699] (Retriever Builder) 強制重建觸發，正在從資料庫執行全量創始構建...
2025-09-30 23:23:13 - [INFO] - [512280345618546699] (Retriever Builder) 執行強制清理，正在刪除舊的向量儲存目錄...
2025-09-30 23:23:13 - [INFO] - [512280345618546699] (Retriever Builder) 已確保向量儲存目錄為全新狀態。
2025-09-30 23:23:13 - [INFO] - [512280345618546699] (Retriever Builder) 已從 SQL 和 LORE 加載 0 條文檔用於創始構建。
2025-09-30 23:23:22 - [INFO] - [512280345618546699] (Retriever Builder) 知識庫為空，已使用手動初始化的 Client 創建一個空的 RAG 系統。
2025-09-30 23:23:22 - [INFO] - [512280345618546699] [後台創世 1/6] 空的 RAG 容器已準備就緒。
2025-09-30 23:23:22 - [INFO] - [512280345618546699] [後台創世 2/6] 正在將世界聖經原文填充進 RAG 索引...
2025-09-30 23:23:22 - [INFO] - [512280345618546699] (Canon Processor) 正在將 34 個世界聖經文本塊添加到 RAG 索引...
2025-09-30 23:23:58 - [INFO] - [512280345618546699] (Canon Processor) ✅ 世界聖經已成功添加到 ChromaDB。
2025-09-30 23:23:58 - [INFO] - [512280345618546699] [後台創世 2/6] RAG 索引填充並重載完成。
2025-09-30 23:23:58 - [INFO] - [512280345618546699] [後台創世 3/6] 正在啟動 RAG 驅動的專職流水線進行 LORE 解析...
2025-09-30 23:23:58 - [INFO] - [512280345618546699] [RAG驱动解析 1/3] 正在使用 LLM 提取并分类所有 LORE 实体...
2025-09-30 23:24:05 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-09-30 23:24:05 - [INFO] - [512280345618546699] [RAG驱动解析 1/3] 成功识别出 84 个 LORE 任务。
2025-09-30 23:24:05 - [INFO] - [512280345618546699] [RAG驱动解析 2/3] 正在按类别分发任务，并【串行】启动所有专职解析流水线以避免速率超限...
2025-09-30 23:24:05 - [INFO] - [512280345618546699] [RAG驱动解析 2/3] 正在串行处理类别: 'npc_profile'...
2025-09-30 23:24:05 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 正在处理批次 1/14...
2025-09-30 23:24:11 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 批次 1 的任务 '提取所有身份、头衔、绰号和别名到 aliases 列表' 已启动...
2025-09-30 23:24:11 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #1) 遭遇內容審查或安全錯誤: BlockedPromptException。
2025-09-30 23:24:11 - [WARNING] - [512280345618546699] 內部鏈意外遭遇審查。啟動【通用化解構-重構】策略...
2025-09-30 23:24:11 - [ERROR] - [512280345618546699] (Euphemizer) 在失敗的 Prompt 中找不到任何可供消毒的已知內容標記，無法執行委婉化。
2025-09-30 23:24:11 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] ✅ 批次 1 的任务 '提取所有身份、头衔、绰号和别名到 aliases 列表' 成功完成。
2025-09-30 23:24:16 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 批次 1 的任务 '提取所有外观细节到 appearance_details 模型' 已启动...
2025-09-30 23:24:21 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #2.
2025-09-30 23:24:21 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] ✅ 批次 1 的任务 '提取所有外观细节到 appearance_details 模型' 成功完成。
2025-09-30 23:24:26 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 批次 1 的任务 '提取角色的背景故事、性格、技能和人际关系' 已启动...
2025-09-30 23:24:27 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #3) 遭遇內容審查或安全錯誤: BlockedPromptException。
2025-09-30 23:24:27 - [WARNING] - [512280345618546699] 內部鏈意外遭遇審查。啟動【通用化解構-重構】策略...
2025-09-30 23:24:27 - [ERROR] - [512280345618546699] (Euphemizer) 在失敗的 Prompt 中找不到任何可供消毒的已知內容標記，無法執行委婉化。
2025-09-30 23:24:27 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] ✅ 批次 1 的任务 '提取角色的背景故事、性格、技能和人际关系' 成功完成。
2025-09-30 23:24:32 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 正在处理批次 2/14...
2025-09-30 23:24:37 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 批次 2 的任务 '提取所有身份、头衔、绰号和别名到 aliases 列表' 已启动...
2025-09-30 23:24:42 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #4.
2025-09-30 23:24:42 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] ✅ 批次 2 的任务 '提取所有身份、头衔、绰号和别名到 aliases 列表' 成功完成。
2025-09-30 23:24:47 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 批次 2 的任务 '提取所有外观细节到 appearance_details 模型' 已启动...
2025-09-30 23:24:52 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #5.
2025-09-30 23:24:52 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] ✅ 批次 2 的任务 '提取所有外观细节到 appearance_details 模型' 成功完成。
2025-09-30 23:24:57 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 批次 2 的任务 '提取角色的背景故事、性格、技能和人际关系' 已启动...
2025-09-30 23:25:05 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-09-30 23:25:05 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] ✅ 批次 2 的任务 '提取角色的背景故事、性格、技能和人际关系' 成功完成。
2025-09-30 23:25:10 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 正在处理批次 3/14...
2025-09-30 23:25:16 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 批次 3 的任务 '提取所有身份、头衔、绰号和别名到 aliases 列表' 已启动...
2025-09-30 23:25:54 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #1.
2025-09-30 23:25:54 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] ✅ 批次 3 的任务 '提取所有身份、头衔、绰号和别名到 aliases 列表' 成功完成。
2025-09-30 23:25:59 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 批次 3 的任务 '提取所有外观细节到 appearance_details 模型' 已启动...
2025-09-30 23:26:04 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #2.
2025-09-30 23:26:04 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] ✅ 批次 3 的任务 '提取所有外观细节到 appearance_details 模型' 成功完成。
2025-09-30 23:26:09 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 批次 3 的任务 '提取角色的背景故事、性格、技能和人际关系' 已启动...
2025-09-30 23:26:17 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #3.
2025-09-30 23:26:17 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] ✅ 批次 3 的任务 '提取角色的背景故事、性格、技能和人际关系' 成功完成。
2025-09-30 23:26:22 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 正在处理批次 4/14...
2025-09-30 23:26:27 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 批次 4 的任务 '提取所有身份、头衔、绰号和别名到 aliases 列表' 已启动...
2025-09-30 23:26:33 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #4.
2025-09-30 23:26:33 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] ✅ 批次 4 的任务 '提取所有身份、头衔、绰号和别名到 aliases 列表' 成功完成。
2025-09-30 23:26:38 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] 批次 4 的任务 '提取所有外观细节到 appearance_details 模型' 已启动...
2025-09-30 23:26:43 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #5.
2025-09-30 23:26:43 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] ✅ 批次 4 的任务 '提取所有外观细节到 appearance_details 模型' 成功完成。
