### AI Lover Log - Last updated at 2025-09-10T08:01:17.756824 ###

  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_chroma\vectorstores.py", line 606, in add_texts
    embeddings = self._embedding_function.embed_documents(texts)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_google_genai\embeddings.py", line 231, in embed_documents
    raise GoogleGenerativeAIError(f"Error embedding content: {e}") from e
langchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerDayPerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerDayPerUserPerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerMinutePerUserPerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerMinutePerProjectPerModel-FreeTier"
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
]
2025-09-10 07:56:01 - [INFO] - Discord Bot is ready and commands are synced!
2025-09-10 07:56:04 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-10 07:56:04 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-10 07:56:05 - [INFO] - 已成功發送啟動成功通知給管理員 (ID: 512280345618546699)。
2025-09-10 07:56:14 - [INFO] - [512280345618546699] 後台重置任務開始...
2025-09-10 07:56:14 - [INFO] - [512280345618546699] 已從 SQL 資料庫安全地清除了所有相關記錄。
2025-09-10 07:56:14 - [INFO] - [512280345618546699] (第 1 次嘗試) 已成功刪除向量數據庫目錄。
2025-09-10 07:56:22 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-09-10 07:56:22 - [INFO] - [512280345618546699] 處於設定流程中，即使資料庫無記錄，也創建一個臨時的記憶體實例。
2025-09-10 07:56:22 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['world_settings']
2025-09-10 07:56:22 - [WARNING] - [512280345618546699] 在持久化更新時找不到使用者資料，將創建新記錄。
2025-09-10 07:56:22 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-10 07:56:32 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['user_profile']
2025-09-10 07:56:32 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-10 07:56:46 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['ai_profile']
2025-09-10 07:56:46 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-10 07:56:54 - [INFO] - [512280345618546699] LLM 實例已使用 API Key #1 創建。下一次將使用 Key #2。
2025-09-10 07:56:55 - [INFO] - [512280345618546699] 資料庫為空，暫時使用純向量檢索器作為基礎。
2025-09-10 07:56:55 - [INFO] - [512280345618546699] RAG 系統升級：成功啟用 Cohere Rerank，已配置先進的「檢索+重排」流程。
2025-09-10 07:56:55 - [INFO] - [512280345618546699] 開始處理批次 1 的第 1/3 輪金鑰快速輪換...
2025-09-10 07:56:55 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #2)...
2025-09-10 07:56:56 - [WARNING] - [512280345618546699] (第 1/6 次嘗試) API Key #2 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:56:56 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #3)...
2025-09-10 07:56:56 - [WARNING] - [512280345618546699] (第 2/6 次嘗試) API Key #3 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:56:56 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #4)...
2025-09-10 07:56:56 - [WARNING] - [512280345618546699] (第 3/6 次嘗試) API Key #4 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:56:56 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #5)...
2025-09-10 07:56:57 - [WARNING] - [512280345618546699] (第 4/6 次嘗試) API Key #5 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:56:57 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #6)...
2025-09-10 07:56:57 - [WARNING] - [512280345618546699] (第 5/6 次嘗試) API Key #6 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:56:57 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #1)...
2025-09-10 07:56:57 - [WARNING] - [512280345618546699] (第 6/6 次嘗試) API Key #1 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:56:57 - [ERROR] - [512280345618546699] 【全局速率限制觸發】在完整輪換所有 6 個 API 金鑰後，批次 1 仍然失敗。
2025-09-10 07:56:57 - [INFO] - [512280345618546699] 系統將進入 65 秒的全局冷卻期，等待 API 配額重置後再開始下一輪嘗試...
2025-09-10 07:58:02 - [INFO] - [512280345618546699] 開始處理批次 1 的第 2/3 輪金鑰快速輪換...
2025-09-10 07:58:02 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #2)...
2025-09-10 07:58:03 - [WARNING] - [512280345618546699] (第 1/6 次嘗試) API Key #2 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:58:03 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #3)...
2025-09-10 07:58:03 - [WARNING] - [512280345618546699] (第 2/6 次嘗試) API Key #3 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:58:03 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #4)...
2025-09-10 07:58:03 - [WARNING] - [512280345618546699] (第 3/6 次嘗試) API Key #4 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:58:03 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #5)...
2025-09-10 07:58:03 - [WARNING] - [512280345618546699] (第 4/6 次嘗試) API Key #5 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:58:03 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #6)...
2025-09-10 07:58:04 - [WARNING] - [512280345618546699] (第 5/6 次嘗試) API Key #6 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:58:04 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #1)...
2025-09-10 07:58:04 - [WARNING] - [512280345618546699] (第 6/6 次嘗試) API Key #1 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:58:04 - [ERROR] - [512280345618546699] 【全局速率限制觸發】在完整輪換所有 6 個 API 金鑰後，批次 1 仍然失敗。
2025-09-10 07:58:04 - [INFO] - [512280345618546699] 系統將進入 65 秒的全局冷卻期，等待 API 配額重置後再開始下一輪嘗試...
2025-09-10 07:59:09 - [INFO] - [512280345618546699] 開始處理批次 1 的第 3/3 輪金鑰快速輪換...
2025-09-10 07:59:09 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #2)...
2025-09-10 07:59:09 - [WARNING] - [512280345618546699] (第 1/6 次嘗試) API Key #2 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:59:09 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #3)...
2025-09-10 07:59:10 - [WARNING] - [512280345618546699] (第 2/6 次嘗試) API Key #3 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:59:10 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #4)...
2025-09-10 07:59:10 - [WARNING] - [512280345618546699] (第 3/6 次嘗試) API Key #4 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:59:10 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #5)...
2025-09-10 07:59:10 - [WARNING] - [512280345618546699] (第 4/6 次嘗試) API Key #5 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:59:10 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #6)...
2025-09-10 07:59:11 - [WARNING] - [512280345618546699] (第 5/6 次嘗試) API Key #6 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:59:11 - [INFO] - [512280345618546699] 正在處理 'canon' 向量化批次 1 (使用 API Key #1)...
2025-09-10 07:59:11 - [WARNING] - [512280345618546699] (第 6/6 次嘗試) API Key #1 遭遇速率限制。正在【立即】輪換到下一個金鑰...
2025-09-10 07:59:11 - [ERROR] - [512280345618546699] 在嘗試了 3 整輪金鑰輪換和延遲後，處理批次 1 最終失敗。請檢查您的 API 金鑰配額。
2025-09-10 07:59:11 - [ERROR] - [512280345618546699] 處理核心設定時發生嚴重錯誤: 在嘗試了 3 整輪金鑰輪換和延遲後，處理批次 1 最終失敗。請檢查您的 API 金鑰配額。
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 2825, in add_canon_to_vector_store
    raise Exception(final_error_msg)
Exception: 在嘗試了 3 整輪金鑰輪換和延遲後，處理批次 1 最終失敗。請檢查您的 API 金鑰配額。
2025-09-10 07:59:11 - [ERROR] - [512280345618546699] 背景處理世界聖經時發生錯誤: 在嘗試了 3 整輪金鑰輪換和延遲後，處理批次 1 最終失敗。請檢查您的 API 金鑰配額。
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\discord_bot.py", line 1552, in _background_process_canon
    chunk_count = await ai_instance.add_canon_to_vector_store(content_text)
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 2825, in add_canon_to_vector_store
    raise Exception(final_error_msg)
Exception: 在嘗試了 3 整輪金鑰輪換和延遲後，處理批次 1 最終失敗。請檢查您的 API 金鑰配額。
