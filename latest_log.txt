### AI Lover Log - Last updated at 2025-09-30T08:07:59.890296 ###

2025-09-30 01:37:01 - [INFO] - [512280345618546699] [關係圖譜校準] 創建反向鏈接: 米婭 -> 瓦勒留斯 (Roles: ['對手'])
2025-09-30 01:37:01 - [INFO] - [512280345618546699] [關係圖譜校準] 更新反向鏈接: 三皇女伊索爾德 -> 博林勳爵 (New Roles: ['工具', '使用者/工具', '使用者'])
2025-09-30 01:37:01 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'npc_profile' 類別處理 64 個實體...
2025-09-30 01:37:01 - [INFO] - [512280345618546699] [API Key Cooling] 跳過冷卻中的 API Key #3 (針對模型 gemini-2.5-pro，剩餘 151 秒)。
2025-09-30 01:38:01 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #4.
2025-09-30 01:38:01 - [INFO] - [512280345618546699] [實體解析] 成功生成解析計畫，包含 64 條決策。
2025-09-30 01:38:09 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'location_info' 類別處理 9 個實體...
2025-09-30 01:38:10 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'item_info' 類別處理 3 個實體...
2025-09-30 01:38:10 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'world_lore' 類別處理 13 個實體...
2025-09-30 01:38:12 - [INFO] - [512280345618546699] [創世 LORE 解析] 管線成功完成。正在觸發 RAG 全量重建...
2025-09-30 01:38:12 - [INFO] - [512280345618546699] (Retriever Builder) 強制重建觸發，正在從資料庫執行全量創始構建...
2025-09-30 01:38:12 - [INFO] - [512280345618546699] (Retriever Builder) 執行強制清理，正在刪除舊的向量儲存目錄...
2025-09-30 01:38:12 - [ERROR] - [512280345618546699] 后台创世流程发生严重错误: [WinError 32] 程序無法存取檔案，因為檔案正由另一個程序使用。: 'D:\\DINO\\SD\\ComfyUI\\personal_server\\ai_lover_service\\data\\vector_stores\\512280345618546699\\c8ede4f6-de4f-41cc-9cc4-e81162ccefe9\\data_level0.bin'
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\discord_bot.py", line 1302, in _perform_full_setup_flow
    await ai_instance.parse_and_create_lore_from_canon(canon_text)
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 4135, in parse_and_create_lore_from_canon
    await self._load_or_build_rag_retriever(force_rebuild=True)
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 545, in _load_or_build_rag_retriever
    shutil.rmtree(self.vector_store_path)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 749, in rmtree
    return _rmtree_unsafe(path, onerror)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 614, in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 619, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\shutil.py", line 617, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 程序無法存取檔案，因為檔案正由另一個程序使用。: 'D:\\DINO\\SD\\ComfyUI\\personal_server\\ai_lover_service\\data\\vector_stores\\512280345618546699\\c8ede4f6-de4f-41cc-9cc4-e81162ccefe9\\data_level0.bin'
2025-09-30 01:38:12 - [INFO] - [512280345618546699] 后台创世流程结束，状态锁已释放。
2025-09-30 01:41:45 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-30 01:41:46 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-30 01:41:46 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-30 01:41:46 - [INFO] - Discord Bot is ready!
2025-09-30 01:41:49 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-30 01:41:49 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-30 01:41:49 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-30 01:45:45 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-30 01:45:45 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-30 01:45:45 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-30 01:45:45 - [INFO] - Discord Bot is ready!
2025-09-30 01:45:48 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-30 01:45:48 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-30 01:45:49 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-30 01:46:02 - [INFO] - [512280345618546699] 後台重置任務開始...
2025-09-30 01:46:02 - [INFO] - [512280345618546699] 未檢測到活躍的 AI 實例，直接進行清理。
2025-09-30 01:46:02 - [INFO] - [512280345618546699] 正在清除所有資料庫記錄...
2025-09-30 01:46:02 - [INFO] - [512280345618546699] 所有資料庫記錄已成功清除。
2025-09-30 01:46:02 - [INFO] - [512280345618546699] (Robust Delete) 正在啟動對目錄 data\vector_stores\512280345618546699 的健壯刪除流程...
2025-09-30 01:46:02 - [INFO] - [512280345618546699] (Robust Delete) ✅ 在第 1 次嘗試中成功刪除目錄: data\vector_stores\512280345618546699
2025-09-30 01:46:06 - [INFO] - [512280345618546699] (UI Event) Persistent 'StartSetupView' button clicked.
2025-09-30 01:46:10 - [INFO] - [512280345618546699] (UI Event) WorldSettingsModal submitted. is_setup_flow: True
2025-09-30 01:46:11 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-09-30 01:46:11 - [INFO] - [512280345618546699] 處於設定流程中，即使資料庫無記錄，也創建一個臨時的記憶體實例。
2025-09-30 01:46:11 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-09-30 01:46:11 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-09-30 01:46:11 - [INFO] - [512280345618546699] 正在創建本地 Embedding 模型 'infgrad/stella-base-zh-v2' 實例...
2025-09-30 01:46:17 - [INFO] - [512280345618546699] ✅ 本地 Embedding 模型實例創建成功。
2025-09-30 01:46:17 - [INFO] - [512280345618546699] (Retriever Builder) 未找到持久化 RAG 索引，正在從資料庫執行全量創始構建...
2025-09-30 01:46:17 - [INFO] - [512280345618546699] (Retriever Builder) 執行強制清理，正在刪除舊的向量儲存目錄...
2025-09-30 01:46:17 - [INFO] - [512280345618546699] (Retriever Builder) 已確保向量儲存目錄為全新狀態。
2025-09-30 01:46:17 - [INFO] - [512280345618546699] (Retriever Builder) 已從 SQL 和 LORE 加載 0 條文檔用於創始構建。
2025-09-30 01:46:23 - [INFO] - [512280345618546699] (Retriever Builder) 知識庫為空，已使用手動配置的 Client 創始化一個空的 RAG 系統。
2025-09-30 01:46:23 - [INFO] - [512280345618546699] 所有構建鏈的前置資源已準備就緒。
2025-09-30 01:46:23 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['world_settings']
2025-09-30 01:46:23 - [WARNING] - [512280345618546699] 在持久化更新時找不到使用者資料，將創建新記錄。
2025-09-30 01:46:23 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 01:46:25 - [INFO] - [512280345618546699] (UI Event) Persistent 'ContinueToUserSetupView' button clicked.
2025-09-30 01:46:32 - [INFO] - [512280345618546699] (UI Event) CharacterSettingsModal submitted for profile_type: 'user', is_setup_flow: True
2025-09-30 01:46:32 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['user_profile']
2025-09-30 01:46:32 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 01:46:34 - [INFO] - [512280345618546699] (UI Event) Persistent 'ContinueToAiSetupView' button clicked.
2025-09-30 01:46:44 - [INFO] - [512280345618546699] (UI Event) CharacterSettingsModal submitted for profile_type: 'ai', is_setup_flow: True
2025-09-30 01:46:45 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['ai_profile']
2025-09-30 01:46:45 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 01:46:48 - [INFO] - [512280345618546699] [创世流程] 档案上传开始，已设置 active_setups 状态锁。
2025-09-30 01:46:56 - [INFO] - [512280345618546699] (on_message) 偵測到用戶處於活躍的創世流程中，已忽略常規訊息 '...' 以防止競爭。
2025-09-30 01:46:59 - [INFO] - [512280345618546699] 独立的后台创世流程已为用户启动。
2025-09-30 01:46:59 - [INFO] - [512280345618546699] [后台创世 1/4] 正在处理世界圣经...
2025-09-30 01:46:59 - [INFO] - [512280345618546699] (Canon Processor) 正在將 34 個世界聖經文本塊添加到 RAG 索引...
2025-09-30 01:47:41 - [INFO] - [512280345618546699] (Canon Processor) ✅ 世界聖經已成功添加到 ChromaDB。
2025-09-30 01:47:41 - [INFO] - [512280345618546699] (Canon Processor) ✅ BM25 索引已同步更新。
2025-09-30 01:47:41 - [INFO] - [512280345618546699] [后台创世 1/4] 正在进行 LORE 智能解析...
2025-09-30 01:47:41 - [INFO] - [512280345618546699] [創世 LORE 解析] 正在啟動多層降級解析管線...
2025-09-30 01:47:41 - [INFO] - [512280345618546699] [LORE 解析] 已將世界聖經原文分割成 8 個文本塊進行處理。
2025-09-30 01:47:41 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 1/8...
2025-09-30 01:47:41 - [INFO] - [512280345618546699] [LORE 解析 1-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 01:47:59 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-09-30 01:47:59 - [INFO] - [512280345618546699] [LORE 解析 1-1/5] ✅ 成功！
2025-09-30 01:47:59 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 2/8...
2025-09-30 01:47:59 - [INFO] - [512280345618546699] [LORE 解析 2-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 01:48:11 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #1.
2025-09-30 01:48:12 - [INFO] - [512280345618546699] [LORE 解析 2-1/5] ✅ 成功！
2025-09-30 01:48:12 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 3/8...
2025-09-30 01:48:12 - [INFO] - [512280345618546699] [LORE 解析 3-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 01:48:26 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #2.
2025-09-30 01:48:26 - [INFO] - [512280345618546699] [LORE 解析 3-1/5] ✅ 成功！
2025-09-30 01:48:26 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 4/8...
2025-09-30 01:48:26 - [INFO] - [512280345618546699] [LORE 解析 4-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 01:48:27 - [ERROR] - [512280345618546699] 在 ainvoke 期間發生未知錯誤 (模型: gemini-2.5-flash-lite): 'int' object has no attribute 'name'
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 855, in ainvoke_with_rotation
    raise BlockedPromptException(f"Prompt blocked due to {response.prompt_feedback.block_reason.name}")
AttributeError: 'int' object has no attribute 'name'
2025-09-30 01:48:27 - [ERROR] - [512280345618546699] [LORE 解析 4-1/5] 遭遇未知錯誤: 'int' object has no attribute 'name'，正在降級。
2025-09-30 01:48:27 - [INFO] - [512280345618546699] [LORE 解析 4-2/5] 正在嘗試【本地備援方案：無審查解析】...
2025-09-30 01:48:27 - [INFO] - [512280345618546699] 正在使用本地模型 'HammerAI/llama-3-lexi-uncensored:latest' 進行LORE解析 (Attempt 1/2)...
2025-09-30 01:50:53 - [INFO] - [512280345618546699] 本地模型在首次嘗試中成功解析並驗證了LORE數據。
2025-09-30 01:50:53 - [WARNING] - [512280345618546699] [LORE 解析 4-2/5] 本地模型未能成功解析，正在降級...
2025-09-30 01:50:53 - [INFO] - [512280345618546699] [LORE 解析 4-3/5] 正在嘗試【安全代碼方案：全文無害化解析】...
2025-09-30 01:50:54 - [ERROR] - [512280345618546699] 在 ainvoke 期間發生未知錯誤 (模型: gemini-2.5-flash-lite): 'int' object has no attribute 'name'
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 855, in ainvoke_with_rotation
    raise BlockedPromptException(f"Prompt blocked due to {response.prompt_feedback.block_reason.name}")
AttributeError: 'int' object has no attribute 'name'
2025-09-30 01:50:54 - [ERROR] - [512280345618546699] [LORE 解析 4-3/5] 遭遇未知錯誤: 'int' object has no attribute 'name'
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 4292, in _execute_lore_parsing_pipeline
    parsing_result = await self.ainvoke_with_rotation(
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 929, in ainvoke_with_rotation
    raise e
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 855, in ainvoke_with_rotation
    raise BlockedPromptException(f"Prompt blocked due to {response.prompt_feedback.block_reason.name}")
AttributeError: 'int' object has no attribute 'name'
2025-09-30 01:50:54 - [INFO] - [512280345618546699] [LORE 解析 4-4/5] 正在嘗試【混合 NLP 方案：靶向精煉】...
2025-09-30 01:50:56 - [ERROR] - [512280345618546699] [LORE 解析 4-4/5] 混合 NLP 方案遭遇未知錯誤: name 'BatchClassificationResult' is not defined
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 4317, in _execute_lore_parsing_pipeline
    classification_result = await self.ainvoke_with_rotation(class_full_prompt, output_schema=BatchClassificationResult)
NameError: name 'BatchClassificationResult' is not defined. Did you mean: 'IntentClassificationResult'?
2025-09-30 01:50:56 - [INFO] - [512280345618546699] [LORE 解析 4-5/5] 正在嘗試【法醫級重構方案】...
2025-09-30 01:50:59 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #5.
2025-09-30 01:50:59 - [INFO] - [512280345618546699] [LORE 解析 4-5/5] ✅ 成功！
2025-09-30 01:50:59 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 5/8...
2025-09-30 01:50:59 - [INFO] - [512280345618546699] [LORE 解析 5-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 01:51:11 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-09-30 01:51:11 - [INFO] - [512280345618546699] [LORE 解析 5-1/5] ✅ 成功！
2025-09-30 01:51:11 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 6/8...
2025-09-30 01:51:11 - [INFO] - [512280345618546699] [LORE 解析 6-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 07:42:24 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-30 07:42:24 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-30 07:42:25 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-30 07:42:25 - [INFO] - Discord Bot is ready!
2025-09-30 07:42:28 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-30 07:42:28 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-30 07:42:28 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-30 08:00:18 - [INFO] - [512280345618546699] 後台重置任務開始...
2025-09-30 08:00:18 - [INFO] - [512280345618546699] 未檢測到活躍的 AI 實例，直接進行清理。
2025-09-30 08:00:18 - [INFO] - [512280345618546699] 正在清除所有資料庫記錄...
2025-09-30 08:00:19 - [INFO] - [512280345618546699] 所有資料庫記錄已成功清除。
2025-09-30 08:00:19 - [INFO] - [512280345618546699] (Robust Delete) 正在啟動對目錄 data\vector_stores\512280345618546699 的健壯刪除流程...
2025-09-30 08:00:19 - [INFO] - [512280345618546699] (Robust Delete) ✅ 在第 1 次嘗試中成功刪除目錄: data\vector_stores\512280345618546699
2025-09-30 08:00:21 - [INFO] - [512280345618546699] (UI Event) Persistent 'StartSetupView' button clicked.
2025-09-30 08:00:27 - [INFO] - [512280345618546699] (UI Event) WorldSettingsModal submitted. is_setup_flow: True
2025-09-30 08:00:27 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-09-30 08:00:27 - [INFO] - [512280345618546699] 處於設定流程中，即使資料庫無記錄，也創建一個臨時的記憶體實例。
2025-09-30 08:00:27 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-09-30 08:00:27 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-09-30 08:00:27 - [INFO] - [512280345618546699] 正在創建本地 Embedding 模型 'infgrad/stella-base-zh-v2' 實例...
2025-09-30 08:00:34 - [INFO] - [512280345618546699] ✅ 本地 Embedding 模型實例創建成功。
2025-09-30 08:00:34 - [INFO] - [512280345618546699] (Retriever Builder) 未找到持久化 RAG 索引，正在從資料庫執行全量創始構建...
2025-09-30 08:00:34 - [INFO] - [512280345618546699] (Retriever Builder) 執行強制清理，正在刪除舊的向量儲存目錄...
2025-09-30 08:00:34 - [INFO] - [512280345618546699] (Retriever Builder) 已確保向量儲存目錄為全新狀態。
2025-09-30 08:00:34 - [INFO] - [512280345618546699] (Retriever Builder) 已從 SQL 和 LORE 加載 0 條文檔用於創始構建。
2025-09-30 08:00:38 - [INFO] - [512280345618546699] (Retriever Builder) 知識庫為空，已使用手動配置的 Client 創始化一個空的 RAG 系統。
2025-09-30 08:00:38 - [INFO] - [512280345618546699] 所有構建鏈的前置資源已準備就緒。
2025-09-30 08:00:38 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['world_settings']
2025-09-30 08:00:38 - [WARNING] - [512280345618546699] 在持久化更新時找不到使用者資料，將創建新記錄。
2025-09-30 08:00:38 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 08:00:40 - [INFO] - [512280345618546699] (UI Event) Persistent 'ContinueToUserSetupView' button clicked.
2025-09-30 08:00:51 - [INFO] - [512280345618546699] (UI Event) CharacterSettingsModal submitted for profile_type: 'user', is_setup_flow: True
2025-09-30 08:00:51 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['user_profile']
2025-09-30 08:00:52 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 08:00:58 - [INFO] - [512280345618546699] (UI Event) Persistent 'ContinueToAiSetupView' button clicked.
2025-09-30 08:01:30 - [INFO] - [512280345618546699] (UI Event) CharacterSettingsModal submitted for profile_type: 'ai', is_setup_flow: True
2025-09-30 08:01:30 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['ai_profile']
2025-09-30 08:01:31 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 08:01:33 - [INFO] - [512280345618546699] [创世流程] 档案上传开始，已设置 active_setups 状态锁。
2025-09-30 08:01:45 - [INFO] - [512280345618546699] (on_message) 偵測到用戶處於活躍的創世流程中，已忽略常規訊息 '...' 以防止競爭。
2025-09-30 08:01:47 - [INFO] - [512280345618546699] 独立的后台创世流程已为用户启动。
2025-09-30 08:01:47 - [INFO] - [512280345618546699] [后台创世 1/4] 正在处理世界圣经...
2025-09-30 08:01:47 - [INFO] - [512280345618546699] (Canon Processor) 正在將 34 個世界聖經文本塊添加到 RAG 索引...
2025-09-30 08:02:29 - [INFO] - [512280345618546699] (Canon Processor) ✅ 世界聖經已成功添加到 ChromaDB。
2025-09-30 08:02:29 - [INFO] - [512280345618546699] (Canon Processor) ✅ BM25 索引已同步更新。
2025-09-30 08:02:29 - [INFO] - [512280345618546699] [后台创世 1/4] 正在进行 LORE 智能解析...
2025-09-30 08:02:29 - [INFO] - [512280345618546699] [創世 LORE 解析] 正在啟動多層降級解析管線...
2025-09-30 08:02:29 - [INFO] - [512280345618546699] [LORE 解析] 已將世界聖經原文分割成 8 個文本塊進行處理。
2025-09-30 08:02:29 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 1/8...
2025-09-30 08:02:29 - [INFO] - [512280345618546699] [LORE 解析 1-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 08:02:47 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-09-30 08:02:47 - [INFO] - [512280345618546699] [LORE 解析 1-1/5] ✅ 成功！
2025-09-30 08:02:47 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 2/8...
2025-09-30 08:02:47 - [INFO] - [512280345618546699] [LORE 解析 2-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 08:03:05 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #1.
2025-09-30 08:03:05 - [INFO] - [512280345618546699] [LORE 解析 2-1/5] ✅ 成功！
2025-09-30 08:03:05 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 3/8...
2025-09-30 08:03:05 - [INFO] - [512280345618546699] [LORE 解析 3-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 08:03:15 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #2.
2025-09-30 08:03:15 - [INFO] - [512280345618546699] [LORE 解析 3-1/5] ✅ 成功！
2025-09-30 08:03:15 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 4/8...
2025-09-30 08:03:15 - [INFO] - [512280345618546699] [LORE 解析 4-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 08:03:16 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #3) 遭遇內容審查或安全錯誤: BlockedPromptException。
2025-09-30 08:03:16 - [WARNING] - [512280345618546699] [LORE 解析 4-1/5] 遭遇內容審查，正在降級...
2025-09-30 08:03:16 - [INFO] - [512280345618546699] [LORE 解析 4-2/5] 正在嘗試【本地備援方案：無審查解析】...
2025-09-30 08:03:16 - [INFO] - [512280345618546699] 正在使用本地模型 'HammerAI/llama-3-lexi-uncensored:latest' 進行LORE解析 (Attempt 1/2)...
2025-09-30 08:06:17 - [INFO] - [512280345618546699] 本地模型在首次嘗試中成功解析並驗證了LORE數據。
2025-09-30 08:06:17 - [WARNING] - [512280345618546699] [LORE 解析 4-2/5] 本地模型未能成功解析，正在降級...
2025-09-30 08:06:17 - [INFO] - [512280345618546699] [LORE 解析 4-3/5] 正在嘗試【安全代碼方案：全文無害化解析】...
2025-09-30 08:06:17 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #4) 遭遇內容審查或安全錯誤: BlockedPromptException。
2025-09-30 08:06:17 - [ERROR] - [512280345618546699] [LORE 解析 4-3/5] 遭遇未知錯誤: Prompt blocked due to 4
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 4299, in _execute_lore_parsing_pipeline
    parsing_result = await self.ainvoke_with_rotation(
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 895, in ainvoke_with_rotation
    raise e
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 862, in ainvoke_with_rotation
    raise BlockedPromptException(f"Prompt blocked due to {reason_str}")
google.generativeai.types.generation_types.BlockedPromptException: Prompt blocked due to 4
2025-09-30 08:06:17 - [INFO] - [512280345618546699] [LORE 解析 4-4/5] 正在嘗試【混合 NLP 方案：靶向精煉】...
2025-09-30 08:06:19 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #5) 遭遇內容審查或安全錯誤: BlockedPromptException。
2025-09-30 08:06:19 - [WARNING] - [512280345618546699] 內部鏈意外遭遇審查。啟動【通用化解構-重構】策略...
2025-09-30 08:06:19 - [ERROR] - [512280345618546699] (Euphemizer) 在失敗的 Prompt 中找不到任何可供消毒的已知內容標記，無法執行委婉化。
2025-09-30 08:06:19 - [INFO] - [512280345618546699] [LORE 解析 4-5/5] 正在嘗試【法醫級重構方案】...
2025-09-30 08:06:24 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-09-30 08:06:24 - [INFO] - [512280345618546699] [LORE 解析 4-5/5] ✅ 成功！
2025-09-30 08:06:24 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 5/8...
2025-09-30 08:06:24 - [INFO] - [512280345618546699] [LORE 解析 5-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 08:06:38 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #1.
2025-09-30 08:06:38 - [INFO] - [512280345618546699] [LORE 解析 5-1/5] ✅ 成功！
2025-09-30 08:06:38 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 6/8...
2025-09-30 08:06:38 - [INFO] - [512280345618546699] [LORE 解析 6-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 08:06:53 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #2.
2025-09-30 08:06:53 - [INFO] - [512280345618546699] [LORE 解析 6-1/5] ✅ 成功！
2025-09-30 08:06:53 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 7/8...
2025-09-30 08:06:53 - [INFO] - [512280345618546699] [LORE 解析 7-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 08:07:03 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #3.
2025-09-30 08:07:03 - [INFO] - [512280345618546699] [LORE 解析 7-1/5] ✅ 成功！
2025-09-30 08:07:03 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 8/8...
2025-09-30 08:07:03 - [INFO] - [512280345618546699] [LORE 解析 8-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-09-30 08:07:08 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #4.
2025-09-30 08:07:08 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #4) 遭遇解析或驗證錯誤: ValidationError。
2025-09-30 08:07:08 - [ERROR] - [512280345618546699] [LORE 解析 8-1/5] 遭遇未知錯誤: 4 validation errors for CanonParsingResult
npc_profiles.0.age
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.1.age
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.2.age
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.3.age
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type，正在降級。
2025-09-30 08:07:08 - [INFO] - [512280345618546699] [LORE 解析 8-2/5] 正在嘗試【本地備援方案：無審查解析】...
2025-09-30 08:07:08 - [INFO] - [512280345618546699] 正在使用本地模型 'HammerAI/llama-3-lexi-uncensored:latest' 進行LORE解析 (Attempt 1/2)...
2025-09-30 08:07:42 - [INFO] - [512280345618546699] 本地模型在首次嘗試中成功解析並驗證了LORE數據。
2025-09-30 08:07:42 - [INFO] - [512280345618546699] [LORE 解析 8-2/5] ✅ 成功！
2025-09-30 08:07:42 - [INFO] - [512280345618546699] [混合式安全驗證器] 正在啟動，對 111 個NPC檔案進行【分批】最終校驗...
2025-09-30 08:07:42 - [INFO] - [512280345618546699] [別名驗證] 正在處理批次 1/12...
2025-09-30 08:07:43 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #5.
2025-09-30 08:07:43 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '絲月' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:43 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '卡爾•維利爾斯勳爵' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:43 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '莉莉絲' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:43 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '薩格納' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:43 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '菲利普•薩格納' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:43 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '米婭' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:43 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '國王埃德蒙三世' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:43 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '阿拉里克' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:43 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '赫克托' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:43 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '伊索爾德' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:45 - [INFO] - [512280345618546699] [別名驗證] 正在處理批次 2/12...
2025-09-30 08:07:47 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-09-30 08:07:47 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '博林' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:47 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '克拉拉' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:47 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '高爾' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:47 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '翠絲' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:47 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '迪茜' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:47 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '亞瑟' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:47 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '老高' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:47 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '艾莉諾' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:47 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '莉莉絲' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:49 - [INFO] - [512280345618546699] [別名驗證] 正在處理批次 3/12...
2025-09-30 08:07:50 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #1.
2025-09-30 08:07:50 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '瑪莉' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:50 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '絲月' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:52 - [INFO] - [512280345618546699] [別名驗證] 正在處理批次 4/12...
2025-09-30 08:07:54 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #2.
2025-09-30 08:07:54 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '卡蓮' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:54 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '凱爾' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:54 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '艾拉' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:54 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '里斯' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:56 - [INFO] - [512280345618546699] [別名驗證] 正在處理批次 5/12...
2025-09-30 08:07:57 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #3.
2025-09-30 08:07:57 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '瓦勒留斯' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:57 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '維利爾斯勳爵' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:57 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '光明神夏卡爾' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:57 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '澤拉' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:57 - [WARNING] - [512280345618546699] [混合式安全驗證器] 檢測到角色 '班恩' 的身份遺漏或偏差，已強制從原文交叉驗證後修正 aliases 列表。
2025-09-30 08:07:59 - [INFO] - [512280345618546699] [別名驗證] 正在處理批次 6/12...
