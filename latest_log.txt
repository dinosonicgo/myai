### AI Lover Log - Last updated at 2025-09-14T20:34:55.270627 ###

  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 2522, in retrieve_and_summarize_memories
    retrieved_docs = await self.retriever.ainvoke(query_text)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\retrievers.py", line 323, in ainvoke
    result = await self._aget_relevant_documents(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain\retrievers\contextual_compression.py", line 69, in _aget_relevant_documents
    docs = await self.base_retriever.ainvoke(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain\retrievers\ensemble.py", line 153, in ainvoke
    result = await self.arank_fusion(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain\retrievers\ensemble.py", line 265, in arank_fusion
    retriever_docs = await asyncio.gather(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\retrievers.py", line 323, in ainvoke
    result = await self._aget_relevant_documents(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\vectorstores\base.py", line 1104, in _aget_relevant_documents
    docs = await self.vectorstore.asimilarity_search(query, **kwargs_)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\vectorstores\base.py", line 648, in asimilarity_search
    return await run_in_executor(None, self.similarity_search, query, k=k, **kwargs)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\runnables\config.py", line 617, in run_in_executor
    return await asyncio.get_running_loop().run_in_executor(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\runnables\config.py", line 608, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_chroma\vectorstores.py", line 681, in similarity_search
    docs_and_scores = self.similarity_search_with_score(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_chroma\vectorstores.py", line 781, in similarity_search_with_score
    query_embedding = self._embedding_function.embed_query(query)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_google_genai\embeddings.py", line 256, in embed_query
    return self.embed_documents(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_google_genai\embeddings.py", line 231, in embed_documents
    raise GoogleGenerativeAIError(f"Error embedding content: {e}") from e
langchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerDayPerUserPerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerMinutePerUserPerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerMinutePerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerDayPerProjectPerModel-FreeTier"
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
]
2025-09-14 19:38:55 - [INFO] - [512280345618546699] 正在創建模型 'gemini-2.5-flash-lite' 實例 (API Key index: 1)
2025-09-14 19:38:55 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-14 19:38:55 - [INFO] - [512280345618546699] 正在創建 Embedding 模型實例 (API Key index: 3)
2025-09-14 19:38:55 - [INFO] - [512280345618546699] 正在創建模型 'gemini-2.5-flash-lite' 實例 (API Key index: 4)
2025-09-14 19:38:57 - [INFO] - [512280345618546699] (LORE Querier) 查詢完成，共找到 0 條唯一的 LORE 記錄。
2025-09-14 19:38:57 - [INFO] - [512280345618546699] (階段 1/3) 上下文預處理完成。
2025-09-14 19:38:57 - [INFO] - [512280345618546699] (階段 2/3) 正在執行單次直連生成...
2025-09-14 19:38:57 - [INFO] - [512280345618546699] [生成] 正在執行單次直連生成...
2025-09-14 19:38:57 - [INFO] - [512280345618546699] 正在創建模型 'gemini-2.5-flash-lite' 實例 (API Key index: 5)
2025-09-14 19:38:57 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-pro' (優先級 1/3) ---
2025-09-14 19:38:57 - [INFO] - [512280345618546699] 正在創建 Embedding 模型實例 (API Key index: 1)
2025-09-14 19:38:57 - [INFO] - [512280345618546699] 正在創建模型 'gemini-2.5-pro' 實例 (API Key index: 2)
2025-09-14 19:39:00 - [INFO] - [512280345618546699] [生成] 單次直連生成成功。
2025-09-14 19:39:00 - [INFO] - [512280345618546699] (階段 2/3) 單次直連生成完成。
2025-09-14 19:39:00 - [INFO] - [512280345618546699] (階段 3/3) 正在執行事後處理...
2025-09-14 19:39:00 - [INFO] - [512280345618546699] [事後處理] 正在更新短期與長期記憶...
2025-09-14 19:39:00 - [INFO] - [512280345618546699] 對話記錄已成功保存到 SQL 資料庫。
2025-09-14 19:39:01 - [WARNING] - [512280345618546699] [優雅降級] 在保存記憶到向量庫時失敗: Error embedding content: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerDayPerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerMinutePerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerMinutePerUserPerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerDayPerUserPerProjectPerModel-FreeTier"
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
]。程式將依賴基於SQL的BM25檢索。
2025-09-14 19:39:01 - [INFO] - [512280345618546699] [事後處理] 記憶更新完成。
2025-09-14 19:39:01 - [INFO] - [512280345618546699] (階段 3/3) 事後處理已啟動。
2025-09-14 19:39:06 - [INFO] - [512280345618546699] [事後處理-LORE] 背景LORE提取器已啟動...
2025-09-14 19:39:06 - [INFO] - [512280345618546699] 正在創建模型 'gemini-2.5-flash-lite' 實例 (API Key index: 3)
2025-09-14 19:39:06 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-14 19:39:06 - [INFO] - [512280345618546699] 正在創建 Embedding 模型實例 (API Key index: 5)
2025-09-14 19:39:06 - [INFO] - [512280345618546699] 正在創建模型 'gemini-2.5-flash-lite' 實例 (API Key index: 0)
2025-09-14 19:39:07 - [INFO] - [512280345618546699] [事後處理-LORE] 提取到 1 條新LORE，準備執行擴展...
2025-09-14 19:39:07 - [INFO] - --- [512280345618546699] 開始串行執行已淨化的場景擴展計畫 (共 1 個任務) ---
2025-09-14 19:39:11 - [INFO] - --- [512280345618546699] 場景擴展計畫執行完畢 ---
2025-09-14 19:39:11 - [INFO] - [512280345618546699] 背景任務的工具上下文已清理。
