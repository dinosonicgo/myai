### AI Lover Log - Last updated at 2025-09-23T00:48:37.323952 ###

2025-09-23 00:25:31 - [INFO] - [512280345618546699] (Canon Processor) 所有 33 个世界圣经文本块均已成功处理并存入 SQL 记忆库。
2025-09-23 00:25:32 - [INFO] - [512280345618546699] 開始智能解析世界聖經文本 (總長度: 26456)...
2025-09-23 00:25:32 - [INFO] - [512280345618546699] 世界聖經已被分割成 7 個文本塊進行處理...
2025-09-23 00:25:32 - [INFO] - [512280345618546699] 正在處理文本塊 1/7...
2025-09-23 00:25:51 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'npc_profile' 類別處理 19 個實體...
2025-09-23 00:25:51 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'location_info' 類別處理 4 個實體...
2025-09-23 00:25:51 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'item_info' 類別處理 10 個實體...
2025-09-23 00:25:51 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'world_lore' 類別處理 2 個實體...
2025-09-23 00:25:54 - [INFO] - [512280345618546699] 文本塊 1 解析並儲存成功。
2025-09-23 00:25:54 - [INFO] - [512280345618546699] 正在處理文本塊 2/7...
2025-09-23 00:26:04 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'npc_profile' 類別處理 21 個實體...
2025-09-23 00:26:04 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'location_info' 類別處理 6 個實體...
2025-09-23 00:26:04 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'world_lore' 類別處理 11 個實體...
2025-09-23 00:26:08 - [INFO] - [512280345618546699] 文本塊 2 解析並儲存成功。
2025-09-23 00:26:08 - [INFO] - [512280345618546699] 正在處理文本塊 3/7...
2025-09-23 00:26:16 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'npc_profile' 類別處理 2 個實體...
2025-09-23 00:26:16 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'location_info' 類別處理 2 個實體...
2025-09-23 00:26:16 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'world_lore' 類別處理 2 個實體...
2025-09-23 00:26:17 - [INFO] - [512280345618546699] 文本塊 3 解析並儲存成功。
2025-09-23 00:26:17 - [INFO] - [512280345618546699] 正在處理文本塊 4/7...
2025-09-23 00:26:18 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #3) 遭遇內容審查或解析錯誤: BlockedPromptException。
2025-09-23 00:26:18 - [WARNING] - [512280345618546699] 處理文本塊 4/7 時發生錯誤 (嘗試 1/2): BlockedPromptException: Prompt blocked due to PROHIBITED_CONTENT
2025-09-23 00:26:20 - [WARNING] - [512280345618546699] 文本塊 4 首次嘗試失敗，正在準備強化重試...
2025-09-23 00:26:20 - [WARNING] - [512280345618546699] [模型升級攻堅] 已注入【零號指令】並將臨時使用 `gemini-2.5-pro` 模型進行最終嘗試。
2025-09-23 00:26:21 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-pro' (Key #4) 遭遇內容審查或解析錯誤: BlockedPromptException。
2025-09-23 00:26:21 - [WARNING] - [512280345618546699] 處理文本塊 4/7 時發生錯誤 (嘗試 2/2): BlockedPromptException: Prompt blocked due to PROHIBITED_CONTENT
2025-09-23 00:26:21 - [ERROR] - [512280345618546699] 文本塊 4/7 在所有重試（包括模型升級）後最終失敗。
2025-09-23 00:26:21 - [INFO] - [512280345618546699] 正在處理文本塊 5/7...
2025-09-23 00:26:39 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #5) 遭遇內容審查或解析錯誤: ValidationError。
2025-09-23 00:26:39 - [WARNING] - [512280345618546699] 處理文本塊 5/7 時發生錯誤 (嘗試 1/2): ValidationError: 3 validation errors for CanonParsingResult
world_lores.8.title
  Field required [type=missing, input_value={'name': '規矩派系', ...tegory': '學術派系'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
world_lores.9.title
  Field required [type=missing, input_value={'name': '快樂派系', ...tegory': '學術派系'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
world_lores.10.title
  Field required [type=missing, input_value={'name': '思想戰爭', ...', 'category': '衝突'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-09-23 00:26:41 - [WARNING] - [512280345618546699] 文本塊 5 首次嘗試失敗，正在準備強化重試...
2025-09-23 00:26:41 - [WARNING] - [512280345618546699] [模型升級攻堅] 已注入【零號指令】並將臨時使用 `gemini-2.5-pro` 模型進行最終嘗試。
2025-09-23 00:28:07 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'npc_profile' 類別處理 16 個實體...
2025-09-23 00:28:07 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'location_info' 類別處理 2 個實體...
2025-09-23 00:28:07 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'quest' 類別處理 1 個實體...
2025-09-23 00:28:07 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'world_lore' 類別處理 4 個實體...
2025-09-23 00:28:10 - [INFO] - [512280345618546699] 文本塊 5 解析並儲存成功。
2025-09-23 00:28:10 - [INFO] - [512280345618546699] 正在處理文本塊 6/7...
2025-09-23 00:28:28 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'npc_profile' 類別處理 25 個實體...
2025-09-23 00:28:28 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'location_info' 類別處理 6 個實體...
2025-09-23 00:28:28 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'world_lore' 類別處理 22 個實體...
2025-09-23 00:28:33 - [INFO] - [512280345618546699] 文本塊 6 解析並儲存成功。
2025-09-23 00:28:33 - [INFO] - [512280345618546699] 正在處理文本塊 7/7...
2025-09-23 00:28:34 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #2) 遭遇內容審查或解析錯誤: BlockedPromptException。
2025-09-23 00:28:34 - [WARNING] - [512280345618546699] 處理文本塊 7/7 時發生錯誤 (嘗試 1/2): BlockedPromptException: Prompt blocked due to PROHIBITED_CONTENT
2025-09-23 00:28:36 - [WARNING] - [512280345618546699] 文本塊 7 首次嘗試失敗，正在準備強化重試...
2025-09-23 00:28:36 - [WARNING] - [512280345618546699] [模型升級攻堅] 已注入【零號指令】並將臨時使用 `gemini-2.5-pro` 模型進行最終嘗試。
2025-09-23 00:28:37 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-pro' (Key #3) 遭遇內容審查或解析錯誤: BlockedPromptException。
2025-09-23 00:28:37 - [WARNING] - [512280345618546699] 處理文本塊 7/7 時發生錯誤 (嘗試 2/2): BlockedPromptException: Prompt blocked due to PROHIBITED_CONTENT
2025-09-23 00:28:37 - [ERROR] - [512280345618546699] 文本塊 7/7 在所有重試（包括模型升級）後最終失敗。
2025-09-23 00:28:37 - [INFO] - [512280345618546699] 世界聖經智能解析與 LORE 創建完成。總共 7 個文本塊，成功處理 5 個。
2025-09-23 00:44:58 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-23 00:44:58 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-23 00:44:59 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-23 00:44:59 - [INFO] - Discord Bot is ready!
2025-09-23 00:45:01 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-23 00:45:01 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-23 00:45:02 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-23 00:45:10 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-09-23 00:45:10 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-09-23 00:45:10 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-09-23 00:45:10 - [INFO] - [512280345618546699] (Retriever Builder) 已從 SQL 和 LORE 加載 301 條文檔用於構建 BM25。
2025-09-23 00:45:10 - [INFO] - [512280345618546699] (Retriever Builder) 純 BM25 檢索器構建成功。
2025-09-23 00:45:10 - [INFO] - [512280345618546699] 所有構建鏈的前置資源已準備就緒。
2025-09-23 00:45:10 - [INFO] - 為使用者 512280345618546699 成功創建並初始化 AI 實例。
2025-09-23 00:45:10 - [INFO] - [512280345618546699] 正在從資料庫恢復短期場景記憶...
2025-09-23 00:45:10 - [INFO] - [512280345618546699] 成功恢復了 1 個場景的對話歷史，總計 1 條訊息。
2025-09-23 00:45:11 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-09-23 00:45:11 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-09-23 00:45:11 - [INFO] - [512280345618546699] (Retriever Builder) 已從 SQL 和 LORE 加載 301 條文檔用於構建 BM25。
2025-09-23 00:45:11 - [INFO] - [512280345618546699] (Retriever Builder) 純 BM25 檢索器構建成功。
2025-09-23 00:45:11 - [INFO] - [512280345618546699] 所有構建鏈的前置資源已準備就緒。
2025-09-23 00:45:11 - [INFO] - [512280345618546699] (Canon Processor) 已从 SQL 记忆库中清理了 33 条旧 'canon' 记录。
2025-09-23 00:45:11 - [INFO] - [512280345618546699] (Canon Processor) 所有 33 个世界圣经文本块均已成功处理并存入 SQL 记忆库。
2025-09-23 00:45:11 - [INFO] - [512280345618546699] 開始智能解析世界聖經文本 (總長度: 26456)...
2025-09-23 00:45:11 - [ERROR] - [512280345618546699] 背景處理世界聖經時發生錯誤: TextSplitter.__init__() got an unexpected keyword argument 'overlap'
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\discord_bot.py", line 1164, in _background_process_canon
    await ai_instance.parse_and_create_lore_from_canon(content_text)
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 1939, in parse_and_create_lore_from_canon
    text_splitter = RecursiveCharacterTextSplitter(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_text_splitters\character.py", line 94, in __init__
    super().__init__(keep_separator=keep_separator, **kwargs)
TypeError: TextSplitter.__init__() got an unexpected keyword argument 'overlap'
2025-09-23 00:48:23 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-23 00:48:23 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-23 00:48:23 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-23 00:48:23 - [INFO] - Discord Bot is ready!
2025-09-23 00:48:26 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-23 00:48:26 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-23 00:48:27 - [INFO] - 已成功發送啟動成功通知給管理員。
