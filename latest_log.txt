### AI Lover Log - Last updated at 2025-10-01T00:23:35.078916 ###

results.12.description
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
results.45.description
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 784, in process_batch_task
    result = await self.ainvoke_with_rotation(full_prompt, output_schema=pydantic_schema, retry_strategy='euphemize')
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 1288, in ainvoke_with_rotation
    raise e
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 1269, in ainvoke_with_rotation
    return output_schema.model_validate(json.loads(clean_json_str))
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\pydantic\main.py", line 568, in model_validate
    return cls.__pydantic_validator__.validate_python(
pydantic_core._pydantic_core.ValidationError: 2 validation errors for BatchCoreInfoResult
results.12.description
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
results.45.description
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
2025-09-30 23:43:43 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] [批次 13/13] 已獲取許可，開始處理 2 個實體...
2025-09-30 23:43:44 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #1.
2025-09-30 23:43:45 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] [批次 11/13] ✅ 處理成功。
2025-09-30 23:43:45 - [INFO] - [512280345618546699] [专职流水线 - location_info] [批次 1/1] 已獲取許可，開始處理 2 個實體...
2025-09-30 23:43:46 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #3.
2025-09-30 23:43:49 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #4.
2025-09-30 23:43:49 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #2.
2025-09-30 23:43:50 - [INFO] - [512280345618546699] [专职流水线 - location_info] [批次 1/1] ✅ 處理成功。
2025-09-30 23:43:50 - [INFO] - [512280345618546699] [专职流水线 - world_lore] [批次 1/2] 已獲取許可，開始處理 5 個實體...
2025-09-30 23:43:51 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #5.
2025-09-30 23:43:55 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #2.
2025-09-30 23:43:56 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] [批次 13/13] ✅ 處理成功。
2025-09-30 23:43:56 - [INFO] - [512280345618546699] [专职流水线 - world_lore] [批次 2/2] 已獲取許可，開始處理 1 個實體...
2025-09-30 23:43:57 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #1.
2025-09-30 23:43:58 - [INFO] - [512280345618546699] [专职流水线 - npc_profile] [批次 12/13] ✅ 處理成功。
2025-09-30 23:43:58 - [INFO] - [512280345618546699] [专职流水线 - item_info] [批次 1/1] 已獲取許可，開始處理 3 個實體...
2025-09-30 23:44:04 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #4.
2025-09-30 23:44:05 - [INFO] - [512280345618546699] [专职流水线 - item_info] [批次 1/1] ✅ 處理成功。
2025-09-30 23:44:05 - [INFO] - [512280345618546699] [专职流水线 - quest] [批次 1/1] 已獲取許可，開始處理 1 個實體...
2025-09-30 23:44:07 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #3.
2025-09-30 23:44:08 - [INFO] - [512280345618546699] [专职流水线 - world_lore] [批次 2/2] ✅ 處理成功。
2025-09-30 23:44:08 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #5.
2025-09-30 23:44:09 - [INFO] - [512280345618546699] [专职流水线 - quest] [批次 1/1] ✅ 處理成功。
2025-09-30 23:44:10 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-09-30 23:44:11 - [INFO] - [512280345618546699] [专职流水线 - world_lore] [批次 1/2] ✅ 處理成功。
2025-09-30 23:44:11 - [INFO] - [512280345618546699] [RAG驱动解析 3/3] 正在合并所有 18 個批次的解析結果...
2025-09-30 23:44:11 - [INFO] - [512280345618546699] [RAG驱动解析 3/3] 数据合并完成。
2025-09-30 23:44:11 - [INFO] - [512280345618546699] [後台創世 3/6] 專職流水線解析完成。
2025-09-30 23:44:11 - [INFO] - [512280345618546699] [後台創世 4/6] 正在將解析出的 LORE 結果持久化到資料庫...
2025-09-30 23:44:11 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'npc_profile' 類別處理 57 個實體...
2025-09-30 23:45:54 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #0.
2025-09-30 23:45:54 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-pro' (Key #0) 遭遇解析或驗證錯誤: ValidationError。
2025-09-30 23:45:54 - [WARNING] - [512280345618546699] [實體解析-自我修正] 批量實體解析遭遇 Pydantic 驗證錯誤。正在啟動自我修正流程...
2025-09-30 23:46:17 - [WARNING] - [512280345618546699] Key #1 (模型: gemini-2.5-pro) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 1.27 秒後進行第 2 次嘗試...
2025-09-30 23:46:19 - [WARNING] - [512280345618546699] Key #1 (模型: gemini-2.5-pro) 遭遇臨時性 API 錯誤 (ResourceExhausted)。將在 2.37 秒後進行第 3 次嘗試...
2025-09-30 23:46:21 - [ERROR] - [512280345618546699] Key #1 (模型: gemini-2.5-pro) 在 3 次內部重試後仍然失敗 (ResourceExhausted)。將輪換到下一個金鑰並觸發持久化冷卻。
2025-09-30 23:46:21 - [CRITICAL] - [512280345618546699] [持久化冷卻] API Key #1 (模型: gemini-2.5-pro) 已被置入冷卻狀態，持續 24 小時。
2025-09-30 23:47:13 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #2.
2025-09-30 23:47:13 - [INFO] - [512280345618546699] [實體解析-自我修正] ✅ 自我修正成功！
2025-09-30 23:47:13 - [INFO] - [512280345618546699] [實體解析] 成功生成解析計畫，包含 2 條決策。
2025-09-30 23:47:15 - [INFO] - [512280345618546699] [後台創世 4/6] LORE 持久化完成。
2025-09-30 23:47:15 - [INFO] - [512280345618546699] [後台創世 5/6] 正在補完使用者與 AI 的角色檔案...
2025-09-30 23:47:18 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #3.
2025-09-30 23:47:18 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #4.
2025-09-30 23:47:18 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['user_profile', 'ai_profile']
2025-09-30 23:47:18 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 23:47:18 - [INFO] - [512280345618546699] [後台創世 6/6] 正在生成世界創世資訊...
2025-09-30 23:47:19 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #5) 遭遇內容審查或安全錯誤: BlockedPromptException。
2025-09-30 23:47:19 - [WARNING] - [512280345618546699] 最終生成鏈遭遇審查。啟動【最高指令集注入重試】策略...
2025-09-30 23:47:19 - [INFO] - [512280345618546699] 已對 Prompt 附加完整的核心指令集，正在進行強化重試...
2025-09-30 23:47:55 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #0.
2025-09-30 23:47:55 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['game_state']
2025-09-30 23:47:56 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-30 23:47:56 - [INFO] - [512280345618546699] [/start] 初始地點 '王國 > 城鎮區 > 咆哮壁爐酒館' 已成功生成並存入LORE。
2025-09-30 23:47:56 - [INFO] - [512280345618546699] [後台創世 7/7] 正在生成開場白...
2025-09-30 23:47:56 - [INFO] - [512280345618546699] [API Key Cooling] 跳過冷卻中的 API Key #1 (針對模型 gemini-2.5-pro，剩餘 86305 秒)。
2025-09-30 23:48:59 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #2.
2025-09-30 23:48:59 - [INFO] - [512280345618546699] [後台創世 7/7] 開場白生成完毕並發送...
2025-09-30 23:49:01 - [INFO] - [512280345618546699] [後台創世] 開場白發送完畢。
2025-09-30 23:49:01 - [INFO] - [512280345618546699] 後台創世流程結束，狀態鎖已釋放。
2025-09-30 23:55:49 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-30 23:55:49 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-30 23:55:50 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-30 23:55:50 - [INFO] - Discord Bot is ready!
2025-09-30 23:55:52 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-30 23:55:52 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-30 23:55:53 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-30 23:57:23 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-30 23:57:23 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-30 23:57:24 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-30 23:57:24 - [INFO] - Discord Bot is ready!
2025-09-30 23:57:26 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-30 23:57:26 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-30 23:57:27 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-30 23:57:37 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-09-30 23:57:37 - [INFO] - 為使用者 512280345618546699 成功創建並初始化 AI 實例。
2025-09-30 23:57:37 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-09-30 23:57:37 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-09-30 23:57:37 - [INFO] - [512280345618546699] 正在創建本地 Embedding 模型 'infgrad/stella-base-zh-v2' 實例...
2025-09-30 23:57:40 - [INFO] - [512280345618546699] ✅ 本地 Embedding 模型實例創建成功。
2025-09-30 23:57:40 - [INFO] - [512280345618546699] 所有輕量級前置資源已準備就緒 (RAG 創建已延遲)。
2025-09-30 23:57:40 - [INFO] - [512280345618546699] (Retriever Builder) 檢測到現有 RAG 索引，正在加載...
2025-09-30 23:57:40 - [WARNING] - [512280345618546699] (Retriever Builder) BM25 持久化檔案不存在或加載失敗，將從 ChromaDB 中恢復語料庫。
2025-09-30 23:57:40 - [INFO] - [512280345618546699] (Retriever Builder) ✅ 混合檢索器已成功從持久化索引加載。
2025-09-30 23:57:40 - [INFO] - [512280345618546699] 正在從資料庫恢復短期場景記憶...
2025-09-30 23:57:40 - [INFO] - [512280345618546699] 成功恢復了 1 個場景的對話歷史，總計 1 條訊息。
2025-09-30 23:57:41 - [INFO] - [512280345618546699] (Canon Processor) 正在將 34 個世界聖經文本塊添加到 RAG 索引...
2025-09-30 23:58:20 - [INFO] - [512280345618546699] (Canon Processor) ✅ 世界聖經已成功添加到 ChromaDB。
2025-09-30 23:58:21 - [ERROR] - [512280345618546699] 背景處理世界聖經時發生錯誤: 'AILover' object has no attribute 'parse_and_create_lore_from_canon'
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\discord_bot.py", line 1414, in _background_process_canon
    await ai_instance.parse_and_create_lore_from_canon(content_text)
AttributeError: 'AILover' object has no attribute 'parse_and_create_lore_from_canon'
2025-10-01 00:00:35 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-10-01 00:00:35 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-10-01 00:00:35 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-10-01 00:00:35 - [INFO] - Discord Bot is ready!
2025-10-01 00:00:38 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-10-01 00:00:38 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-10-01 00:00:39 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-10-01 00:00:49 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-10-01 00:00:49 - [INFO] - 為使用者 512280345618546699 成功創建並初始化 AI 實例。
2025-10-01 00:00:49 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-10-01 00:00:49 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-10-01 00:00:49 - [INFO] - [512280345618546699] 正在創建本地 Embedding 模型 'infgrad/stella-base-zh-v2' 實例...
2025-10-01 00:00:52 - [INFO] - [512280345618546699] ✅ 本地 Embedding 模型實例創建成功。
2025-10-01 00:00:52 - [INFO] - [512280345618546699] 所有輕量級前置資源已準備就緒 (RAG 創建已延遲)。
2025-10-01 00:00:52 - [INFO] - [512280345618546699] (Retriever Builder) 檢測到現有 RAG 索引，正在加載...
2025-10-01 00:00:52 - [INFO] - [512280345618546699] [RAG持久化] 成功從磁碟加載了 34 條文檔到 RAG 語料庫。
2025-10-01 00:00:52 - [INFO] - [512280345618546699] (Retriever Builder) ✅ 混合檢索器已成功從持久化索引加載。
2025-10-01 00:00:52 - [INFO] - [512280345618546699] 正在從資料庫恢復短期場景記憶...
2025-10-01 00:00:52 - [INFO] - [512280345618546699] 成功恢復了 1 個場景的對話歷史，總計 1 條訊息。
2025-10-01 00:00:52 - [INFO] - [512280345618546699] [Canon Update] 正在為聖經更新重建 RAG 索引...
2025-10-01 00:00:52 - [INFO] - [512280345618546699] (Retriever Builder) 強制重建觸發，正在從資料庫執行全量創始構建...
2025-10-01 00:00:52 - [INFO] - [512280345618546699] (Retriever Builder) 執行強制清理，正在刪除舊的向量儲存目錄...
2025-10-01 00:00:52 - [INFO] - [512280345618546699] (Retriever Builder) 已確保向量儲存目錄為全新狀態。
2025-10-01 00:00:52 - [INFO] - [512280345618546699] (Retriever Builder) 已從 SQL 和 LORE 加載 2 條文檔用於創始構建。
2025-10-01 00:00:54 - [INFO] - [512280345618546699] (Retriever Builder) ✅ 混合檢索器創始構建成功，並已將索引持久化到磁碟。
2025-10-01 00:00:54 - [INFO] - [512280345618546699] (Canon Processor) 正在將 34 個世界聖經文本塊添加到 RAG 索引...
2025-10-01 00:01:35 - [INFO] - [512280345618546699] (Canon Processor) ✅ 世界聖經已成功添加到 ChromaDB。
2025-10-01 00:01:36 - [INFO] - [512280345618546699] [LORE 解析] 已將世界聖經原文分割成 8 個文本塊進行處理。
2025-10-01 00:01:36 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 1/8...
2025-10-01 00:01:36 - [INFO] - [512280345618546699] [LORE 解析 1-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:01:59 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-01 00:01:59 - [INFO] - [512280345618546699] [LORE 解析 1-1/5] ✅ 成功！
2025-10-01 00:01:59 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 2/8...
2025-10-01 00:01:59 - [INFO] - [512280345618546699] [LORE 解析 2-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:02:18 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #1.
2025-10-01 00:02:18 - [INFO] - [512280345618546699] [LORE 解析 2-1/5] ✅ 成功！
2025-10-01 00:02:18 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 3/8...
2025-10-01 00:02:18 - [INFO] - [512280345618546699] [LORE 解析 3-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:02:18 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #2) 遭遇內容審查或安全錯誤: BlockedPromptException。
2025-10-01 00:02:18 - [WARNING] - [512280345618546699] 內部鏈意外遭遇審查。啟動【通用化解構-重構】策略...
2025-10-01 00:02:18 - [INFO] - [512280345618546699] (Euphemizer) 已提取安全的情報殘片: ['ROLE-D', 'CODE-F-GEN-B', 'STATE-A', 'CODE-M-GEN-A', 'CODE-F-GEN-A', 'ROLE-B']
2025-10-01 00:02:47 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #3.
2025-10-01 00:02:47 - [INFO] - [512280345618546699] (Euphemizer) [適配層] 正在將法醫級重構結果 (CanonParsingResult) 適配到上游期望的 Schema (CanonParsingResult)...
2025-10-01 00:02:47 - [INFO] - [512280345618546699] [LORE 解析 3-1/5] ✅ 成功！
2025-10-01 00:02:47 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 4/8...
2025-10-01 00:02:47 - [INFO] - [512280345618546699] [LORE 解析 4-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:02:47 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #4) 遭遇內容審查或安全錯誤: BlockedPromptException。
2025-10-01 00:02:47 - [WARNING] - [512280345618546699] 內部鏈意外遭遇審查。啟動【通用化解構-重構】策略...
2025-10-01 00:02:47 - [INFO] - [512280345618546699] (Euphemizer) 已提取安全的情報殘片: ['ROLE-D', 'CODE-F-GEN-C', 'ACTION-C', 'ACTION-E', 'CODE-F-GEN-A', 'ROLE-B']
2025-10-01 00:02:47 - [INFO] - [512280345618546699] [API Key Cooling] 跳過冷卻中的 API Key #5 (針對模型 gemini-2.5-pro，剩餘 80494 秒)。
2025-10-01 00:03:07 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #0.
2025-10-01 00:03:07 - [INFO] - [512280345618546699] (Euphemizer) [適配層] 正在將法醫級重構結果 (CanonParsingResult) 適配到上游期望的 Schema (CanonParsingResult)...
2025-10-01 00:03:07 - [INFO] - [512280345618546699] [LORE 解析 4-1/5] ✅ 成功！
2025-10-01 00:03:07 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 5/8...
2025-10-01 00:03:07 - [INFO] - [512280345618546699] [LORE 解析 5-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:03:20 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #1.
2025-10-01 00:03:20 - [INFO] - [512280345618546699] [LORE 解析 5-1/5] ✅ 成功！
2025-10-01 00:03:20 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 6/8...
2025-10-01 00:03:20 - [INFO] - [512280345618546699] [LORE 解析 6-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:03:39 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #2.
2025-10-01 00:03:39 - [INFO] - [512280345618546699] [LORE 解析 6-1/5] ✅ 成功！
2025-10-01 00:03:39 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 7/8...
2025-10-01 00:03:39 - [INFO] - [512280345618546699] [LORE 解析 7-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:04:00 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #3.
2025-10-01 00:04:00 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #3) 遭遇解析或驗證錯誤: ValidationError。
2025-10-01 00:04:00 - [ERROR] - [512280345618546699] [LORE 解析 7-1/5] 遭遇未知錯誤: 11 validation errors for CanonParsingResult
npc_profiles.7.appearance
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.8.appearance
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.9.appearance
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.10.appearance
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.12.appearance
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.13.appearance
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.14.appearance
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.16.appearance
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.17.appearance
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.18.appearance
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type
npc_profiles.20.appearance
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.8/v/string_type，正在降級。
2025-10-01 00:04:00 - [INFO] - [512280345618546699] [LORE 解析 7-2/5] 正在嘗試【本地備援方案：無審查解析】...
2025-10-01 00:04:00 - [INFO] - [512280345618546699] 正在使用本地模型 'HammerAI/llama-3-lexi-uncensored:latest' 進行LORE解析 (Attempt 1/2)...
2025-10-01 00:08:17 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-10-01 00:08:17 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-10-01 00:08:18 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-10-01 00:08:18 - [INFO] - Discord Bot is ready!
2025-10-01 00:08:20 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-10-01 00:08:20 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-10-01 00:08:21 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-10-01 00:08:31 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-10-01 00:08:31 - [INFO] - 為使用者 512280345618546699 成功創建並初始化 AI 實例。
2025-10-01 00:08:31 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-10-01 00:08:31 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-10-01 00:08:31 - [INFO] - [512280345618546699] 正在創建本地 Embedding 模型 'infgrad/stella-base-zh-v2' 實例...
2025-10-01 00:08:38 - [INFO] - [512280345618546699] ✅ 本地 Embedding 模型實例創建成功。
2025-10-01 00:08:38 - [INFO] - [512280345618546699] 所有輕量級前置資源已準備就緒 (RAG 創建已延遲)。
2025-10-01 00:08:38 - [INFO] - [512280345618546699] (Retriever Builder) 檢測到現有 RAG 索引，正在加載...
2025-10-01 00:08:38 - [INFO] - [512280345618546699] [RAG持久化] 成功從磁碟加載了 2 條文檔到 RAG 語料庫。
2025-10-01 00:08:38 - [INFO] - [512280345618546699] (Retriever Builder) ✅ 混合檢索器已成功從持久化索引加載。
2025-10-01 00:08:38 - [INFO] - [512280345618546699] 正在從資料庫恢復短期場景記憶...
2025-10-01 00:08:38 - [INFO] - [512280345618546699] 成功恢復了 1 個場景的對話歷史，總計 1 條訊息。
2025-10-01 00:08:38 - [INFO] - [512280345618546699] [Canon Update] 正在為聖經更新重建 RAG 索引...
2025-10-01 00:08:38 - [INFO] - [512280345618546699] (Retriever Builder) 強制重建觸發，正在從資料庫執行全量創始構建...
2025-10-01 00:08:38 - [INFO] - [512280345618546699] (Retriever Builder) 執行強制清理，正在刪除舊的向量儲存目錄...
2025-10-01 00:08:38 - [INFO] - [512280345618546699] (Retriever Builder) 已確保向量儲存目錄為全新狀態。
2025-10-01 00:08:38 - [INFO] - [512280345618546699] (Retriever Builder) 已從 SQL 和 LORE 加載 2 條文檔用於創始構建。
2025-10-01 00:08:40 - [INFO] - [512280345618546699] (Retriever Builder) ✅ 混合檢索器創始構建成功，並已將索引持久化到磁碟。
2025-10-01 00:08:41 - [INFO] - [512280345618546699] (Canon Processor) 正在將 34 個世界聖經文本塊添加到 RAG 索引...
2025-10-01 00:09:19 - [INFO] - [512280345618546699] (Canon Processor) ✅ 世界聖經已成功添加到 ChromaDB。
2025-10-01 00:09:20 - [INFO] - [512280345618546699] [LORE 解析] 已將世界聖經原文分割成 8 個文本塊進行處理。
2025-10-01 00:09:20 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 1/8...
2025-10-01 00:09:20 - [INFO] - [512280345618546699] [LORE 解析 1-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:09:37 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-01 00:09:37 - [INFO] - [512280345618546699] [LORE 解析 1-1/5] ✅ 成功！
2025-10-01 00:09:37 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 2/8...
2025-10-01 00:09:37 - [INFO] - [512280345618546699] [LORE 解析 2-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:09:55 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #1.
2025-10-01 00:09:55 - [INFO] - [512280345618546699] [LORE 解析 2-1/5] ✅ 成功！
2025-10-01 00:09:55 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 3/8...
2025-10-01 00:09:55 - [INFO] - [512280345618546699] [LORE 解析 3-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:09:55 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #2) 遭遇內容審查或安全錯誤: BlockedPromptException。
2025-10-01 00:09:55 - [WARNING] - [512280345618546699] 內部鏈意外遭遇審查。啟動【通用化解構-重構】策略...
2025-10-01 00:09:55 - [INFO] - [512280345618546699] (Euphemizer) 已提取安全的情報殘片: ['CODE-M-GEN-A', 'STATE-A', 'ROLE-D', 'CODE-F-GEN-A', 'ROLE-B', 'CODE-F-GEN-B']
2025-10-01 00:10:23 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #3.
2025-10-01 00:10:23 - [INFO] - [512280345618546699] (Euphemizer) [適配層] 正在將法醫級重構結果 (CanonParsingResult) 適配到上游期望的 Schema (CanonParsingResult)...
2025-10-01 00:10:23 - [INFO] - [512280345618546699] [LORE 解析 3-1/5] ✅ 成功！
2025-10-01 00:10:23 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 4/8...
2025-10-01 00:10:23 - [INFO] - [512280345618546699] [LORE 解析 4-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:10:23 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #4) 遭遇內容審查或安全錯誤: BlockedPromptException。
2025-10-01 00:10:23 - [WARNING] - [512280345618546699] 內部鏈意外遭遇審查。啟動【通用化解構-重構】策略...
2025-10-01 00:10:23 - [INFO] - [512280345618546699] (Euphemizer) 已提取安全的情報殘片: ['CODE-F-GEN-C', 'ACTION-E', 'ROLE-D', 'CODE-F-GEN-A', 'ROLE-B', 'ACTION-C']
2025-10-01 00:10:23 - [INFO] - [512280345618546699] [API Key Cooling] 跳過冷卻中的 API Key #5 (針對模型 gemini-2.5-pro，剩餘 80038 秒)。
2025-10-01 00:10:46 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #0.
2025-10-01 00:10:46 - [INFO] - [512280345618546699] (Euphemizer) [適配層] 正在將法醫級重構結果 (CanonParsingResult) 適配到上游期望的 Schema (CanonParsingResult)...
2025-10-01 00:10:46 - [INFO] - [512280345618546699] [LORE 解析 4-1/5] ✅ 成功！
2025-10-01 00:10:46 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 5/8...
2025-10-01 00:10:46 - [INFO] - [512280345618546699] [LORE 解析 5-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:10:57 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #1.
2025-10-01 00:10:57 - [INFO] - [512280345618546699] [LORE 解析 5-1/5] ✅ 成功！
2025-10-01 00:10:57 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 6/8...
2025-10-01 00:10:57 - [INFO] - [512280345618546699] [LORE 解析 6-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:11:13 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #2.
2025-10-01 00:11:13 - [INFO] - [512280345618546699] [LORE 解析 6-1/5] ✅ 成功！
2025-10-01 00:11:13 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 7/8...
2025-10-01 00:11:13 - [INFO] - [512280345618546699] [LORE 解析 7-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:11:32 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #3.
2025-10-01 00:11:32 - [INFO] - [512280345618546699] [LORE 解析 7-1/5] ✅ 成功！
2025-10-01 00:11:32 - [INFO] - [512280345618546699] [LORE 解析] 正在處理文本塊 8/8...
2025-10-01 00:11:32 - [INFO] - [512280345618546699] [LORE 解析 8-1/5] 正在嘗試【理想方案：雲端宏觀解析】...
2025-10-01 00:11:38 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #4.
2025-10-01 00:11:38 - [INFO] - [512280345618546699] [LORE 解析 8-1/5] ✅ 成功！
2025-10-01 00:11:38 - [INFO] - [512280345618546699] [Canon Update] 管道解析成功，準備儲存所有LORE類別...
2025-10-01 00:11:38 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'npc_profile' 類別處理 102 個實體...
2025-10-01 00:11:38 - [INFO] - [512280345618546699] [API Key Cooling] 跳過冷卻中的 API Key #5 (針對模型 gemini-2.5-pro，剩餘 79963 秒)。
2025-10-01 00:13:52 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #0.
2025-10-01 00:18:35 - [INFO] - [512280345618546699] [實體解析] 成功生成解析計畫，包含 102 條決策。
2025-10-01 00:18:35 - [CRITICAL] - 【重大錯誤】與 Discord 的 WebSocket 連線已中斷！
2025-10-01 00:18:37 - [INFO] - [512280345618546699] [LORE合併] 正在為 1 個NPC執行批量描述合成...
2025-10-01 00:18:37 - [INFO] - [512280345618546699] [API Key Cooling] 跳過冷卻中的 API Key #1 (針對模型 gemini-2.5-pro，剩餘 84465 秒)。
2025-10-01 00:18:43 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-10-01 00:18:50 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #2.
2025-10-01 00:18:50 - [INFO] - [512280345618546699] [LORE合併] LLM 合成成功，收到 1 條新描述。
2025-10-01 00:18:59 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'location_info' 類別處理 27 個實體...
2025-10-01 00:19:02 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'item_info' 類別處理 1 個實體...
2025-10-01 00:19:02 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'quest' 類別處理 1 個實體...
2025-10-01 00:19:02 - [INFO] - [512280345618546699] (_resolve_and_save) 正在為 'world_lore' 類別處理 30 個實體...
