### AI Lover Log - Last updated at 2025-09-29T23:35:51.728767 ###

2025-09-29 21:49:28 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-29 21:49:37 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-29 22:02:06 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-29 22:02:06 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-29 22:02:07 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-29 22:02:07 - [INFO] - Discord Bot is ready!
2025-09-29 22:02:09 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-29 22:02:09 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-29 22:02:10 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-29 22:02:48 - [INFO] - [512280345618546699] 後台重置任務開始...
2025-09-29 22:02:48 - [INFO] - [512280345618546699] 正在从数据库删除所有相关数据...
2025-09-29 22:02:49 - [INFO] - [512280345618546699] 数据库清理完成。
2025-09-29 22:02:53 - [INFO] - [512280345618546699] (UI Event) Persistent 'StartSetupView' button clicked.
2025-09-29 22:02:58 - [INFO] - [512280345618546699] (UI Event) WorldSettingsModal submitted. is_setup_flow: True
2025-09-29 22:02:58 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-09-29 22:02:58 - [INFO] - [512280345618546699] 處於設定流程中，即使資料庫無記錄，也創建一個臨時的記憶體實例。
2025-09-29 22:02:58 - [ERROR] - [512280345618546699] 致命錯誤: 未找到核心數據模板 'world_snapshot_template.txt'！
2025-09-29 22:02:58 - [CRITICAL] - [512280345618546699] 致命錯誤: 未找到核心協議 '00_supreme_directive.txt'！
2025-09-29 22:02:58 - [INFO] - [512280345618546699] [RAG Mode] 正在嘗試初始化【混合雲端模式】...
2025-09-29 22:02:58 - [INFO] - [512280345618546699] 正在創建 Embedding 模型實例 (API Key index: 0)
2025-09-29 22:02:58 - [WARNING] - [512280345618546699] [RAG Mode] 初始化【混合雲端模式】失敗: GoogleGenerativeAIError。正在降級...
2025-09-29 22:02:58 - [INFO] - [512280345618546699] [RAG Mode] 正在嘗試初始化【混合本地模式】（將自動從鏡像源下載）...
2025-09-29 22:03:02 - [ERROR] - [512280345618546699] [RAG Mode] 初始化【混合本地模式】最終失敗 (可能是模型下載/加載問題): Could not import sentence_transformers python package. Please install it with `pip install sentence-transformers`.
Traceback (most recent call last):
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_google_genai\embeddings.py", line 225, in embed_documents
    result = self.client.batch_embed_contents(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 1365, in batch_embed_contents
    response = rpc(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits.
* Quota exceeded for metric: generativelanguage.googleapis.com/embed_content_free_tier_requests, limit: 0
* Quota exceeded for metric: generativelanguage.googleapis.com/embed_content_free_tier_requests, limit: 0
* Quota exceeded for metric: generativelanguage.googleapis.com/embed_content_free_tier_requests, limit: 0
* Quota exceeded for metric: generativelanguage.googleapis.com/embed_content_free_tier_requests, limit: 0 [violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerDayPerUserPerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerMinutePerUserPerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerMinutePerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerDayPerProjectPerModel-FreeTier"
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 3553, in _configure_pre_requisites
    await google_embeddings.aembed_query("test")
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\embeddings\embeddings.py", line 79, in aembed_query
    return await run_in_executor(None, self.embed_query, text)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\runnables\config.py", line 590, in run_in_executor
    return await asyncio.get_running_loop().run_in_executor(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\runnables\config.py", line 581, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_google_genai\embeddings.py", line 254, in embed_query
    return self.embed_documents(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_google_genai\embeddings.py", line 229, in embed_documents
    raise GoogleGenerativeAIError(f"Error embedding content: {e}") from e
langchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits.
* Quota exceeded for metric: generativelanguage.googleapis.com/embed_content_free_tier_requests, limit: 0
* Quota exceeded for metric: generativelanguage.googleapis.com/embed_content_free_tier_requests, limit: 0
* Quota exceeded for metric: generativelanguage.googleapis.com/embed_content_free_tier_requests, limit: 0
* Quota exceeded for metric: generativelanguage.googleapis.com/embed_content_free_tier_requests, limit: 0 [violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerDayPerUserPerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerMinutePerUserPerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerMinutePerProjectPerModel-FreeTier"
}
violations {
  quota_metric: "generativelanguage.googleapis.com/embed_content_free_tier_requests"
  quota_id: "EmbedContentRequestsPerDayPerProjectPerModel-FreeTier"
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 2154, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 2184, in _get_module
    raise e
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 2182, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\modeling_utils.py", line 73, in <module>
    from .loss.loss_utils import LOSS_MAPPING
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\loss\loss_utils.py", line 21, in <module>
    from .loss_d_fine import DFineForObjectDetectionLoss
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\loss\loss_d_fine.py", line 21, in <module>
    from .loss_for_object_detection import (
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\loss\loss_for_object_detection.py", line 32, in <module>
    from transformers.image_transforms import center_to_corners_format
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\image_transforms.py", line 22, in <module>
    from .image_utils import (
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\image_utils.py", line 59, in <module>
    from torchvision.transforms import InterpolationMode
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\torchvision\_meta_registrations.py", line 164, in <module>
    def meta_nms(dets, scores, iou_threshold):
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\library.py", line 1069, in register
    use_lib._register_fake(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\library.py", line 219, in _register_fake
    handle = entry.fake_impl.register(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\_library\fake_impl.py", line 50, in register
    if torch._C._dispatch_has_kernel_for_dispatch_key(self.qualname, "Meta"):
RuntimeError: operator torchvision::nms does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_community\embeddings\huggingface.py", line 84, in __init__
    import sentence_transformers
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\__init__.py", line 15, in <module>
    from sentence_transformers.cross_encoder import (
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\cross_encoder\__init__.py", line 3, in <module>
    from .CrossEncoder import CrossEncoder
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\cross_encoder\CrossEncoder.py", line 16, in <module>
    from transformers import (
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 2157, in __getattr__
    raise ModuleNotFoundError(
ModuleNotFoundError: Could not import module 'PreTrainedModel'. Are this object's requirements defined correctly?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 3567, in _configure_pre_requisites
    self.embeddings = HuggingFaceEmbeddings(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\_api\deprecation.py", line 215, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_community\embeddings\huggingface.py", line 87, in __init__
    raise ImportError(
ImportError: Could not import sentence_transformers python package. Please install it with `pip install sentence-transformers`.
2025-09-29 22:03:02 - [CRITICAL] - [512280345618546699] [RAG Mode] 🔥 所有 Embedding 方案均失敗！系統已降級至【純關鍵字模式】。
2025-09-29 22:03:02 - [INFO] - [512280345618546699] (Retriever Builder) 正在構建 RAG 檢索器 (模式: keyword_only, 強制重建: False)...
2025-09-29 22:03:02 - [INFO] - [512280345618546699] (Retriever Builder) ⚠️ SQL 知識庫為空，BM25 檢索器未初始化。
2025-09-29 22:03:02 - [WARNING] - [512280345618546699] (Retriever Builder) ⚠️ 語意搜索功能未啟用，跳過初始化 ChromaDB 檢索器。
2025-09-29 22:03:02 - [ERROR] - [512280345618546699] (Retriever Builder) 🔥 所有檢索器均初始化失敗！RAG 系統將返回空結果。
2025-09-29 22:03:02 - [INFO] - [512280345618546699] 所有構建鏈的前置資源已準備就緒 (當前 RAG 模式: keyword_only)。
2025-09-29 22:03:02 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['world_settings']
2025-09-29 22:03:02 - [WARNING] - [512280345618546699] 在持久化更新時找不到使用者資料，將創建新記錄。
2025-09-29 22:03:02 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-29 23:07:38 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-29 23:07:38 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-29 23:07:39 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-29 23:07:39 - [INFO] - Discord Bot is ready!
2025-09-29 23:07:43 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-29 23:07:43 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-29 23:07:44 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-29 23:09:30 - [INFO] - [512280345618546699] 後台重置任務開始...
2025-09-29 23:09:30 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-09-29 23:09:30 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-09-29 23:09:30 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-09-29 23:09:30 - [INFO] - [512280345618546699] (Retriever Builder) 未找到持久化 RAG 索引，正在從資料庫執行全量創始構建...
2025-09-29 23:09:30 - [INFO] - [512280345618546699] (Retriever Builder) 已從 SQL 和 LORE 加載 0 條文檔用於創始構建。
2025-09-29 23:09:30 - [INFO] - [512280345618546699] (Retriever Builder) 知識庫為空，創始構建為空。
2025-09-29 23:09:30 - [INFO] - [512280345618546699] 所有構建鏈的前置資源已準備就緒。
2025-09-29 23:09:30 - [INFO] - 為使用者 512280345618546699 成功創建並初始化 AI 實例。
2025-09-29 23:09:30 - [INFO] - [512280345618546699] 正在從資料庫恢復短期場景記憶...
2025-09-29 23:09:30 - [INFO] - [512280345618546699] 資料庫中沒有找到歷史場景記憶。
2025-09-29 23:09:30 - [INFO] - [512280345618546699] 正在關閉 AI 實例並釋放資源...
2025-09-29 23:09:31 - [INFO] - [512280345618546699] AI 實例資源已釋放。
2025-09-29 23:09:33 - [INFO] - [512280345618546699] 正在清除所有短期場景記憶...
2025-09-29 23:09:33 - [INFO] - [512280345618546699] 已成功從資料庫中刪除 0 條場景歷史記錄。
2025-09-29 23:09:36 - [INFO] - [512280345618546699] (UI Event) Persistent 'StartSetupView' button clicked.
2025-09-29 23:09:41 - [INFO] - [512280345618546699] (UI Event) WorldSettingsModal submitted. is_setup_flow: True
2025-09-29 23:09:42 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-09-29 23:09:42 - [INFO] - [512280345618546699] 處於設定流程中，即使資料庫無記錄，也創建一個臨時的記憶體實例。
2025-09-29 23:09:42 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-09-29 23:09:42 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-09-29 23:09:42 - [INFO] - [512280345618546699] (Retriever Builder) 未找到持久化 RAG 索引，正在從資料庫執行全量創始構建...
2025-09-29 23:09:42 - [INFO] - [512280345618546699] (Retriever Builder) 已從 SQL 和 LORE 加載 0 條文檔用於創始構建。
2025-09-29 23:09:42 - [INFO] - [512280345618546699] (Retriever Builder) 知識庫為空，創始構建為空。
2025-09-29 23:09:42 - [INFO] - [512280345618546699] 所有構建鏈的前置資源已準備就緒。
2025-09-29 23:09:42 - [INFO] - [512280345618546699] 接收到 profile 更新請求: ['world_settings']
2025-09-29 23:09:42 - [WARNING] - [512280345618546699] 在持久化更新時找不到使用者資料，將創建新記錄。
2025-09-29 23:09:42 - [INFO] - [512280345618546699] Profile 更新並持久化成功。
2025-09-29 23:27:18 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-29 23:27:18 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-29 23:27:18 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-29 23:27:18 - [INFO] - Discord Bot is ready!
2025-09-29 23:27:21 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-29 23:27:21 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-29 23:27:22 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-29 23:30:06 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-29 23:30:06 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-29 23:30:06 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-29 23:30:06 - [INFO] - Discord Bot is ready!
2025-09-29 23:30:09 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-29 23:30:09 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-29 23:30:10 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-29 23:30:20 - [INFO] - [512280345618546699] 後台重置任務開始...
2025-09-29 23:30:20 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-09-29 23:30:21 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-09-29 23:30:21 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-09-29 23:30:21 - [INFO] - [512280345618546699] 正在創建本地 Embedding 模型 'infgrad/stella-base-zh-v3' 實例...
2025-09-29 23:30:27 - [ERROR] - [512280345618546699] 🔥 創建本地 Embedding 模型實例時發生致命錯誤: Failed to import transformers.trainer because of the following error (look up to see its traceback):
cannot import name 'EncoderDecoderCache' from 'transformers' (C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\__init__.py)
Traceback (most recent call last):
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 1535, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\trainer.py", line 213, in <module>
    from peft import PeftModel
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\peft\__init__.py", line 17, in <module>
    from .auto import (
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\peft\auto.py", line 32, in <module>
    from .peft_model import (
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\peft\peft_model.py", line 37, in <module>
    from transformers import Cache, DynamicCache, EncoderDecoderCache, HybridCache, PreTrainedModel
ImportError: cannot import name 'EncoderDecoderCache' from 'transformers' (C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\__init__.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 3703, in _create_embeddings_instance
    embeddings = HuggingFaceEmbeddings(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\_api\deprecation.py", line 215, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_community\embeddings\huggingface.py", line 71, in __init__
    import sentence_transformers
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\__init__.py", line 15, in <module>
    from sentence_transformers.trainer import SentenceTransformerTrainer
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\sentence_transformers\trainer.py", line 10, in <module>
    from transformers import EvalPrediction, PreTrainedTokenizerBase, Trainer, TrainerCallback
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 1525, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\utils\import_utils.py", line 1537, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.trainer because of the following error (look up to see its traceback):
cannot import name 'EncoderDecoderCache' from 'transformers' (C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\__init__.py)
2025-09-29 23:30:27 - [ERROR] -    -> 請確保 `torch`, `transformers` 和 `sentence-transformers` 已正確安裝。
2025-09-29 23:30:27 - [ERROR] - [512280345618546699] (Retriever Builder) Embedding 模型未初始化，無法構建檢索器。
2025-09-29 23:30:27 - [INFO] - [512280345618546699] 所有構建鏈的前置資源已準備就緒。
2025-09-29 23:30:27 - [INFO] - 為使用者 512280345618546699 成功創建並初始化 AI 實例。
2025-09-29 23:30:27 - [INFO] - [512280345618546699] 正在從資料庫恢復短期場景記憶...
2025-09-29 23:30:27 - [INFO] - [512280345618546699] 資料庫中沒有找到歷史場景記憶。
2025-09-29 23:30:27 - [INFO] - [512280345618546699] 正在關閉 AI 實例並釋放資源...
2025-09-29 23:30:28 - [INFO] - [512280345618546699] AI 實例資源已釋放。
2025-09-29 23:30:30 - [INFO] - [512280345618546699] 正在清除所有短期場景記憶...
2025-09-29 23:30:30 - [INFO] - [512280345618546699] 已成功從資料庫中刪除 0 條場景歷史記錄。
2025-09-29 23:35:37 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-29 23:35:37 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-29 23:35:38 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-29 23:35:38 - [INFO] - Discord Bot is ready!
2025-09-29 23:35:41 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-29 23:35:41 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-29 23:35:41 - [INFO] - 已成功發送啟動成功通知給管理員。
