### AI Lover Log - Last updated at 2025-09-21T22:38:58.109926 ###

2025-09-21 22:20:24 - [INFO] - [512280345618546699] 已為新實體 '克拉拉' (標準名: 克拉拉) 創建了 LORE 條目，主鍵為 '克拉拉'。
2025-09-21 22:20:28 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:20:29 - [INFO] - [512280345618546699] 已為新實體 '老高' (標準名: 老高) 創建了 LORE 條目，主鍵為 '老高'。
2025-09-21 22:20:33 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:20:34 - [INFO] - [512280345618546699] 已為新實體 '馬丁' (標準名: 馬丁) 創建了 LORE 條目，主鍵為 '馬丁'。
2025-09-21 22:20:38 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:20:39 - [INFO] - [512280345618546699] 已為新實體 '亞瑟' (標準名: 亞瑟) 創建了 LORE 條目，主鍵為 '亞瑟'。
2025-09-21 22:20:43 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:20:44 - [INFO] - [512280345618546699] 已為新實體 '朱利安' (標準名: 朱利安) 創建了 LORE 條目，主鍵為 '朱利安'。
2025-09-21 22:20:48 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:20:49 - [INFO] - [512280345618546699] 已為新實體 '阿利斯特' (標準名: 阿利斯特) 創建了 LORE 條目，主鍵為 '阿利斯特'。
2025-09-21 22:20:53 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:20:54 - [INFO] - [512280345618546699] 已為新實體 '瑪莉' (標準名: 瑪莉) 創建了 LORE 條目，主鍵為 '瑪莉'。
2025-09-21 22:20:58 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:20:59 - [INFO] - [512280345618546699] 已為新實體 '安娜' (標準名: 安娜) 創建了 LORE 條目，主鍵為 '安娜'。
2025-09-21 22:21:03 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:21:04 - [INFO] - [512280345618546699] 已為新實體 '老羅' (標準名: 老羅) 創建了 LORE 條目，主鍵為 '老羅'。
2025-09-21 22:21:08 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:21:09 - [INFO] - [512280345618546699] 已為新實體 '馬克' (標準名: 馬克) 創建了 LORE 條目，主鍵為 '馬克'。
2025-09-21 22:21:13 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:21:14 - [INFO] - [512280345618546699] 已為新實體 '費奇' (標準名: 費奇) 創建了 LORE 條目，主鍵為 '費奇'。
2025-09-21 22:21:18 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:21:19 - [INFO] - [512280345618546699] 已為新實體 '湯瑪斯' (標準名: 湯瑪斯) 創建了 LORE 條目，主鍵為 '湯瑪斯'。
2025-09-21 22:21:23 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:21:24 - [INFO] - [512280345618546699] 已為新實體 '愛蓮娜' (標準名: 愛蓮娜) 創建了 LORE 條目，主鍵為 '愛蓮娜'。
2025-09-21 22:21:28 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:21:29 - [INFO] - [512280345618546699] 已為新實體 '埃德蒙三世' (標準名: 埃德蒙三世) 創建了 LORE 條目，主鍵為 '埃德蒙三世'。
2025-09-21 22:21:33 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:21:34 - [INFO] - [512280345618546699] 已為新實體 '赫克托' (標準名: 赫克托) 創建了 LORE 條目，主鍵為 '赫克托'。
2025-09-21 22:21:38 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:21:39 - [INFO] - [512280345618546699] 已為新實體 '阿拉里克' (標準名: 阿拉里克) 創建了 LORE 條目，主鍵為 '阿拉里克'。
2025-09-21 22:21:43 - [INFO] - [512280345618546699] --- 開始嘗試模型: 'gemini-2.5-flash-lite' (優先級 1/1) ---
2025-09-21 22:27:48 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-21 22:27:48 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-21 22:27:48 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-21 22:27:48 - [INFO] - Discord Bot is ready!
2025-09-21 22:27:51 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-21 22:27:51 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-21 22:27:51 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-09-21 22:28:36 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-09-21 22:28:36 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-09-21 22:28:36 - [INFO] - [512280345618546699] 核心協議模板 '00_supreme_directive.txt' 已成功加載並設置。
2025-09-21 22:28:36 - [INFO] - [512280345618546699] 已精簡模組化提示詞加載，只保留核心協議。
2025-09-21 22:28:36 - [INFO] - [512280345618546699] 正在創建模型 'gemini-2.5-flash-lite' 實例 (API Key index: 0)
2025-09-21 22:28:36 - [INFO] - [512280345618546699] 正在創建 Embedding 模型實例 (API Key index: 1)
2025-09-21 22:28:36 - [INFO] - [512280345618546699] (Retriever Builder) 已從 SQL 加載 31 條記憶。
2025-09-21 22:28:36 - [INFO] - [512280345618546699] (Retriever Builder) BM25 備援檢索器構建成功。
2025-09-21 22:28:37 - [INFO] - [512280345618546699] (Retriever Builder) ChromaDB 主要檢索器構建成功。
2025-09-21 22:28:37 - [INFO] - [512280345618546699] (Retriever Builder) 混合檢索器構建成功。
2025-09-21 22:28:37 - [INFO] - [512280345618546699] 所有構建鏈的前置資源已準備就緒。
2025-09-21 22:28:37 - [INFO] - 為使用者 512280345618546699 成功創建並初始化 AI 實例。
2025-09-21 22:28:38 - [INFO] - [512280345618546699] (Canon Processor) 已从 SQL 记忆库中清理了 31 条旧 'canon' 记录。
2025-09-21 22:28:38 - [INFO] - [512280345618546699] (Canon Processor) 所有 31 个世界圣经文本块均已成功处理并存入 SQL 记忆库 (BM25 備援方案)。
2025-09-21 22:28:39 - [WARNING] - [512280345618546699] (Canon Processor) [優雅降級] 主記憶系統 (Embedding) 在處理世界聖經時失敗。程式將自動使用備援記憶系統 (BM25)。錯誤類型: GoogleGenerativeAIError
2025-09-21 22:28:39 - [INFO] - [512280345618546699] 開始智能解析世界聖經文本 (總長度: 24402)...
2025-09-21 22:28:39 - [INFO] - [512280345618546699] 世界聖經已被分割成 4 個文本塊進行處理。
2025-09-21 22:28:39 - [INFO] - [512280345618546699] 正在解析文本塊 1/4...
2025-09-21 22:28:44 - [INFO] - [512280345618546699] 正在輕量級重建核心模型 (目標: gemini-2.5-pro) 以應用金鑰策略...
2025-09-21 22:28:44 - [INFO] - [512280345618546699] 正在創建模型 'gemini-2.5-pro' 實例 (API Key index: 2)
2025-09-21 22:28:44 - [INFO] - [512280345618546699] 正在創建 Embedding 模型實例 (API Key index: 3)
2025-09-21 22:28:44 - [INFO] - [512280345618546699] 核心模型已成功重建。
2025-09-21 22:28:44 - [ERROR] - [512280345618546699] 處理文本塊 1 時發生未知錯誤: 'ChatPromptValue' object has no attribute 'npc_profiles'
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 2689, in parse_and_create_lore_from_canon
    all_parsing_results.npc_profiles.extend(chunk_result.npc_profiles)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\pydantic\main.py", line 991, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'ChatPromptValue' object has no attribute 'npc_profiles'
2025-09-21 22:28:44 - [INFO] - [512280345618546699] 正在解析文本塊 2/4...
2025-09-21 22:28:49 - [INFO] - [512280345618546699] 正在輕量級重建核心模型 (目標: gemini-2.5-pro) 以應用金鑰策略...
2025-09-21 22:28:49 - [INFO] - [512280345618546699] 正在創建模型 'gemini-2.5-pro' 實例 (API Key index: 4)
2025-09-21 22:28:49 - [INFO] - [512280345618546699] 正在創建 Embedding 模型實例 (API Key index: 5)
2025-09-21 22:28:49 - [INFO] - [512280345618546699] 核心模型已成功重建。
2025-09-21 22:28:49 - [ERROR] - [512280345618546699] 處理文本塊 2 時發生未知錯誤: 'ChatPromptValue' object has no attribute 'npc_profiles'
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 2689, in parse_and_create_lore_from_canon
    all_parsing_results.npc_profiles.extend(chunk_result.npc_profiles)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\pydantic\main.py", line 991, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'ChatPromptValue' object has no attribute 'npc_profiles'
2025-09-21 22:28:49 - [INFO] - [512280345618546699] 正在解析文本塊 3/4...
2025-09-21 22:28:54 - [INFO] - [512280345618546699] 正在輕量級重建核心模型 (目標: gemini-2.5-pro) 以應用金鑰策略...
2025-09-21 22:28:54 - [INFO] - [512280345618546699] 正在創建模型 'gemini-2.5-pro' 實例 (API Key index: 0)
2025-09-21 22:28:54 - [INFO] - [512280345618546699] 正在創建 Embedding 模型實例 (API Key index: 1)
2025-09-21 22:28:54 - [INFO] - [512280345618546699] 核心模型已成功重建。
2025-09-21 22:28:54 - [ERROR] - [512280345618546699] 處理文本塊 3 時發生未知錯誤: 'ChatPromptValue' object has no attribute 'npc_profiles'
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 2689, in parse_and_create_lore_from_canon
    all_parsing_results.npc_profiles.extend(chunk_result.npc_profiles)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\pydantic\main.py", line 991, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'ChatPromptValue' object has no attribute 'npc_profiles'
2025-09-21 22:28:54 - [INFO] - [512280345618546699] 正在解析文本塊 4/4...
2025-09-21 22:38:43 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-09-21 22:38:43 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-09-21 22:38:44 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-09-21 22:38:44 - [INFO] - Discord Bot is ready!
2025-09-21 22:38:47 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-09-21 22:38:47 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-09-21 22:38:47 - [INFO] - 已成功發送啟動成功通知給管理員。
