### AI Lover Log - Last updated at 2025-10-04T23:49:56.020742 ###

  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\language_models\chat_models.py", line 787, in agenerate_prompt
    return await self.agenerate(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\language_models\chat_models.py", line 747, in agenerate
    raise exceptions[0]
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\language_models\chat_models.py", line 923, in _agenerate_with_cache
    result = await self._agenerate(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_google_genai\chat_models.py", line 809, in _agenerate
    return _response_to_result(response)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_google_genai\chat_models.py", line 558, in _response_to_result
    generation_info["finish_reason"] = candidate.finish_reason.name
AttributeError: 'int' object has no attribute 'name'
2025-10-04 19:43:36 - [ERROR] - 處理使用者 512280345618546699 的 RAG 直通流程時發生異常: 'int' object has no attribute 'name'
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\discord_bot.py", line 1354, in on_message
    final_response = await ai_instance.direct_rag_generate(user_input)
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 519, in direct_rag_generate
    final_response = await self.ainvoke_with_rotation(
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 1404, in ainvoke_with_rotation
    raise e
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 1292, in ainvoke_with_rotation
    response = await asyncio.wait_for(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\tasks.py", line 445, in wait_for
    return fut.result()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\language_models\chat_models.py", line 298, in ainvoke
    llm_result = await self.agenerate_prompt(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\language_models\chat_models.py", line 787, in agenerate_prompt
    return await self.agenerate(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\language_models\chat_models.py", line 747, in agenerate
    raise exceptions[0]
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_core\language_models\chat_models.py", line 923, in _agenerate_with_cache
    result = await self._agenerate(
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_google_genai\chat_models.py", line 809, in _agenerate
    return _response_to_result(response)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\site-packages\langchain_google_genai\chat_models.py", line 558, in _response_to_result
    generation_info["finish_reason"] = candidate.finish_reason.name
AttributeError: 'int' object has no attribute 'name'
2025-10-04 20:47:19 - [INFO] - 正在編譯主對話圖 (main_graph)...
2025-10-04 20:47:19 - [INFO] - ✅ 主對話圖編譯成功。
2025-10-04 20:47:19 - [INFO] - 正在編譯創世流程圖 (setup_graph)...
2025-10-04 20:47:19 - [INFO] - ✅ 創世流程圖編譯成功。
2025-10-04 20:47:19 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-10-04 20:47:19 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-10-04 20:47:19 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-10-04 20:47:19 - [INFO] - Discord Bot is ready!
2025-10-04 20:47:22 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-10-04 20:47:22 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-10-04 20:47:23 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-10-04 20:50:39 - [INFO] - 正在編譯主對話圖 (main_graph)...
2025-10-04 20:50:39 - [INFO] - ✅ 主對話圖編譯成功。
2025-10-04 20:50:39 - [INFO] - 正在編譯創世流程圖 (setup_graph)...
2025-10-04 20:50:39 - [INFO] - ✅ 創世流程圖編譯成功。
2025-10-04 20:50:39 - [INFO] - 所有持久化 UI 視圖已成功註冊。
2025-10-04 20:50:39 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-10-04 20:50:39 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-10-04 20:50:39 - [INFO] - Discord Bot is ready!
2025-10-04 20:50:42 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-10-04 20:50:42 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-10-04 20:50:43 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-10-04 22:15:10 - [INFO] - Cog 與背景任務已成功註冊，持久化 UI 視圖將在 on_ready 中註冊。
2025-10-04 22:15:10 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-10-04 22:15:10 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-10-04 22:15:10 - [INFO] - Discord Bot setup hook finished!
2025-10-04 22:15:13 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-10-04 22:15:13 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-10-04 22:15:13 - [INFO] - Bot 首次準備就緒，正在註冊持久化 UI 視圖...
2025-10-04 22:16:28 - [INFO] - Cog 與背景任務已成功註冊，持久化 UI 視圖將在 on_ready 中註冊。
2025-10-04 22:16:28 - [INFO] - 正在嘗試將應用程式指令 (Slash Commands) 全域同步到 Discord...
2025-10-04 22:16:28 - [INFO] - ✅ 應用程式指令全域同步成功！(注意：全域指令更新可能需要長達一小時才能在所有伺服器生效)
2025-10-04 22:16:28 - [INFO] - Discord Bot setup hook finished!
2025-10-04 22:16:31 - [INFO] - 【健康檢查 & Keep-Alive】背景任務已啟動。
2025-10-04 22:16:31 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-10-04 22:16:31 - [INFO] - Bot 首次準備就緒，正在註冊持久化 UI 視圖...
2025-10-04 22:21:03 - [INFO] - 正在 setup_hook 中註冊持久化 UI 視圖...
2025-10-04 22:23:53 - [INFO] - 正在 setup_hook 中註冊持久化 UI 視圖...
2025-10-04 23:06:38 - [INFO] - 正在加載核心 Cog (core_cog)...
2025-10-04 23:06:41 - [INFO] - ✅ 核心 Cog (core_cog) 已加載，並且所有持久化視圖已成功註冊。
2025-10-04 23:06:41 - [INFO] - ✅ 核心 Cog 加載成功。
2025-10-04 23:06:41 - [INFO] - 正在全域同步應用程式指令...
2025-10-04 23:06:42 - [INFO] - ✅ 指令已全域同步！
2025-10-04 23:06:42 - [INFO] - Discord Bot setup hook finished!
2025-10-04 23:06:45 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-10-04 23:06:45 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-10-04 23:06:54 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-10-04 23:06:54 - [INFO] - 為使用者 512280345618546699 成功創建並初始化 AI 實例。
2025-10-04 23:06:54 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-10-04 23:06:54 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-10-04 23:06:54 - [INFO] - ✅ [Embedding Loader] 檢測到本地模型路徑，正在嘗試從 'D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\models\stella-base-zh-v2' 加載...
2025-10-04 23:07:01 - [INFO] - ✅ [Embedding Loader] 本地 Embedding 模型實例創建成功。
2025-10-04 23:07:01 - [INFO] - [512280345618546699] 所有輕量級前置資源已準備就緒 (RAG 創建已延遲)。
2025-10-04 23:07:01 - [INFO] - [512280345618546699] (Retriever Builder) 檢測到現有 RAG 索引，正在加載...
2025-10-04 23:07:01 - [WARNING] - [512280345618546699] (Retriever Builder) BM25 持久化檔案不存在或加載失敗，將從 ChromaDB 中恢復 BM25 專用語料庫。
2025-10-04 23:07:01 - [INFO] - [512280345618546699] (Retriever Builder) ✅ 混合檢索器已成功從持久化索引加載。
2025-10-04 23:07:01 - [INFO] - [512280345618546699] 正在從資料庫恢復短期場景記憶...
2025-10-04 23:07:01 - [INFO] - [512280345618546699] 成功恢復了 1 個場景的對話歷史，總計 1 條訊息。
2025-10-04 23:07:01 - [INFO] - [512280345618546699] 啟動 RAG 直通對話流程...
2025-10-04 23:07:01 - [INFO] - [512280345618546699] [Direct RAG] 啟動 LORE 優先的 RAG 直通生成流程...
2025-10-04 23:07:01 - [INFO] - [512280345618546699] [實體名稱提取] 正在從查詢 '抓住碧的頭髮，讓她為我口交...' 中分析實體...
2025-10-04 23:07:01 - [INFO] - [512280345618546699] [輸入分析-L1] 正在嘗試使用 LLM 進行語義分析...
2025-10-04 23:07:02 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:07:02 - [INFO] - [512280345618546699] [輸入分析-L1] ✅ LLM 分析成功。提取實體: ['碧']
2025-10-04 23:07:02 - [INFO] - [512280345618546699] [實體名稱提取] 查詢分析完成，共識別出 2 個核心實體: ['DINO', '碧']。
2025-10-04 23:07:02 - [INFO] - [512280345618546699] [實體名稱提取] 正在從查詢 '抓住碧的頭髮，讓她為我口交...' 中分析實體...
2025-10-04 23:07:02 - [INFO] - [512280345618546699] [輸入分析-L1] 正在嘗試使用 LLM 進行語義分析...
2025-10-04 23:07:03 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:07:03 - [INFO] - [512280345618546699] [輸入分析-L1] ✅ LLM 分析成功。提取實體: ['碧']
2025-10-04 23:07:03 - [INFO] - [512280345618546699] [實體名稱提取] 查詢分析完成，共識別出 2 個核心實體: ['DINO', '碧']。
2025-10-04 23:07:03 - [INFO] - [512280345618546699] [RAG 原文直通] 查詢已擴展為: '抓住碧的頭髮，讓她為我口交 DINO 碧'
2025-10-04 23:07:04 - [INFO] - [512280345618546699] [RAG 原文直通] 粗略檢索成功，獲得 20 份候選文檔。
2025-10-04 23:07:04 - [INFO] - [512280345618546699] [RAG 原文直通] ✅ 成功拼接全部 20 條原始文檔作為 summary_context。
2025-10-04 23:07:06 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:07:39 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #0.
2025-10-04 23:07:40 - [INFO] - [512280345618546699] RAG 直通流程執行完畢，回應已發送。事後學習任務已在背景啟動。
2025-10-04 23:07:42 - [INFO] - [512280345618546699] [事後分析] 正在啟動背景分析與分流任務...
2025-10-04 23:07:44 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #0) 遭遇靜默失敗，生成因 '8' 而提前終止。
2025-10-04 23:07:44 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #0) 遭遇內容審查或安全錯誤: BlockedPromptException。
2025-10-04 23:07:44 - [WARNING] - [512280345618546699] 內部鏈意外遭遇審查。啟動【通用化解構-重構】策略...
2025-10-04 23:07:44 - [INFO] - [512280345618546699] (Euphemizer) 已提取安全的情報殘片: ['碧', 'ACTION-B', 'ROLE-B', 'REACT-B', 'DINO', 'CODE-M-GEN-A']
2025-10-04 23:08:01 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #0.
2025-10-04 23:08:01 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-pro' (Key #0) 遭遇解析或驗證錯誤: JSONDecodeError。啟動【自我修正】流程...
2025-10-04 23:08:01 - [WARNING] - [512280345618546699] 導致解析錯誤的原始 LLM 輸出: 
--- START RAW ---
```json
{
  "npc_profiles": [
    {
      "name": "碧",
      "aliases": [],
      "description": "一位神秘而強勢的女性。根據殘片情報推斷，她扮演著 `ROLE-B` 的角色，並對一頭龍型生物進行了高度親密的互動。",
      "location_path": [],
      "gender": "女",
      "race": "未知",
      "status": "活躍",
      "age": "未知 (推測為成年)",
      "appearance": "外貌不詳，但其行為透露出極大的自信與掌控力。",
      "skills": [
        "異種生物調教",
        "精神支配"
      ]
    }
  ],
  "locations": [],
  "items": [],
  "creatures": [
    {
      "name": "DINO",
      "aliases": [
        "龍獸"
      ],
      "description": "一頭被稱為'DINO'的龍型生物。情報顯示其擁有巨大的 `CODE-M-GEN-A`，並在與'碧'的互動中產生了 `REACT-B` 的強烈生理反應。",
      "abilities": [
        "強大的肉體",
        "對特定刺激產生劇烈反應"
      ]
    }
  ],
  "quests": [],
  "world_lores": [
    {
      "title": "碧與龍獸的支配儀式",
      "aliases": [],
      "content": "根據一份殘缺的情報記錄，名為'碧'的個體以 `ROLE-B` 的身份，對一頭代號為'DINO'的龍型生物的 `CODE-M-GEN-A` 執行了 `ACTION-B`。在此過程中，該生物出現了 `REACT-B` 的生理反應。此事件揭示了異種生物之間可能存在的複雜權力與支配服從關係。",
      "category": "異聞錄"
    }
  ]
}
```
--- END RAW ---
2025-10-04 23:08:03 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:08:03 - [INFO] - [512280345618546699] [自我修正] ✅ 修正流程成功，正在重新驗證...
2025-10-04 23:08:03 - [INFO] - [512280345618546699] [事後分析] 背景分析與分流任務完成。
2025-10-04 23:17:31 - [INFO] - 正在加載核心 Cog (core_cog)...
2025-10-04 23:17:35 - [INFO] - ✅ 核心 Cog (core_cog) 已加載，並且所有持久化視圖已成功註冊。
2025-10-04 23:17:35 - [INFO] - ✅ 核心 Cog 加載成功。
2025-10-04 23:17:35 - [INFO] - 正在全域同步應用程式指令...
2025-10-04 23:17:35 - [INFO] - ✅ 指令已全域同步！
2025-10-04 23:17:35 - [INFO] - Discord Bot setup hook finished!
2025-10-04 23:17:38 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-10-04 23:17:38 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-10-04 23:23:13 - [INFO] - 正在加載核心 Cog (core_cog)...
2025-10-04 23:23:16 - [INFO] - ✅ 核心 Cog (core_cog) 已加載，並且所有持久化視圖已成功註冊。
2025-10-04 23:23:16 - [INFO] - ✅ 核心 Cog 加載成功。
2025-10-04 23:23:16 - [INFO] - 正在全域同步應用程式指令...
2025-10-04 23:23:17 - [INFO] - ✅ 指令已全域同步！
2025-10-04 23:23:17 - [INFO] - Discord Bot setup hook finished!
2025-10-04 23:23:19 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-10-04 23:23:20 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-10-04 23:25:40 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-10-04 23:25:40 - [INFO] - 為使用者 512280345618546699 成功創建並初始化 AI 實例。
2025-10-04 23:25:40 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-10-04 23:25:40 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-10-04 23:25:40 - [INFO] - ✅ [Embedding Loader] 檢測到本地模型路徑，正在嘗試從 'D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\models\stella-base-zh-v2' 加載...
2025-10-04 23:25:42 - [INFO] - ✅ [Embedding Loader] 本地 Embedding 模型實例創建成功。
2025-10-04 23:25:42 - [INFO] - [512280345618546699] 所有輕量級前置資源已準備就緒 (RAG 創建已延遲)。
2025-10-04 23:25:42 - [INFO] - [512280345618546699] (Retriever Builder) 檢測到現有 RAG 索引，正在加載...
2025-10-04 23:25:42 - [INFO] - [512280345618546699] [RAG持久化] 成功從磁碟加載了 34 條文檔到 RAG 語料庫。
2025-10-04 23:25:42 - [INFO] - [512280345618546699] (Retriever Builder) ✅ 混合檢索器已成功從持久化索引加載。
2025-10-04 23:25:42 - [INFO] - [512280345618546699] 正在從資料庫恢復短期場景記憶...
2025-10-04 23:25:42 - [INFO] - [512280345618546699] 成功恢復了 1 個場景的對話歷史，總計 3 條訊息。
2025-10-04 23:25:42 - [INFO] - [512280345618546699] 啟動 RAG 直通對話流程...
2025-10-04 23:25:42 - [INFO] - [512280345618546699] [Direct RAG] 啟動 LORE 優先的 RAG 直通生成流程...
2025-10-04 23:25:42 - [INFO] - [512280345618546699] [LORE 擴展] 正在檢查是否需要擴展 LORE...
2025-10-04 23:25:43 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:25:44 - [INFO] - [512280345618546699] [LORE 擴展] 無需擴展新的 LORE。
2025-10-04 23:25:44 - [INFO] - [512280345618546699] [實體名稱提取] 正在從查詢 '抓著碧，深喉嚨口交...' 中分析實體...
2025-10-04 23:25:44 - [INFO] - [512280345618546699] [輸入分析-L1] 正在嘗試使用 LLM 進行語義分析...
2025-10-04 23:25:45 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:25:45 - [INFO] - [512280345618546699] [輸入分析-L1] ✅ LLM 分析成功。提取實體: ['碧']
2025-10-04 23:25:45 - [INFO] - [512280345618546699] [實體名稱提取] 查詢分析完成，共識別出 2 個核心實體: ['DINO', '碧']。
2025-10-04 23:25:45 - [INFO] - [512280345618546699] [實體名稱提取] 正在從查詢 '抓著碧，深喉嚨口交...' 中分析實體...
2025-10-04 23:25:45 - [INFO] - [512280345618546699] [輸入分析-L1] 正在嘗試使用 LLM 進行語義分析...
2025-10-04 23:25:46 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:25:46 - [INFO] - [512280345618546699] [輸入分析-L1] ✅ LLM 分析成功。提取實體: ['碧']
2025-10-04 23:25:46 - [INFO] - [512280345618546699] [實體名稱提取] 查詢分析完成，共識別出 2 個核心實體: ['DINO', '碧']。
2025-10-04 23:25:46 - [INFO] - [512280345618546699] [RAG 原文直通] 查詢已擴展為: '抓著碧，深喉嚨口交 DINO 碧'
2025-10-04 23:25:47 - [INFO] - [512280345618546699] [RAG 原文直通] 粗略檢索成功，獲得 18 份候選文檔。
2025-10-04 23:25:47 - [INFO] - [512280345618546699] [RAG 原文直通] ✅ 成功拼接全部 18 條原始文檔作為 summary_context。
2025-10-04 23:25:47 - [ERROR] - 處理使用者 512280345618546699 的 RAG 直通流程時發生異常: 'AILover' object has no attribute 'DECODING_MAP'
Traceback (most recent call last):
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\cogs\core_cog.py", line 698, in on_message
    final_response = await ai_instance.direct_rag_generate(user_input)
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 482, in direct_rag_generate
    rag_context_dict = await self.retrieve_and_summarize_memories(user_input)
  File "D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\src\ai_core.py", line 5917, in retrieve_and_summarize_memories
    final_summary = self._decode_lore_content(summary_context, self.DECODING_MAP)
AttributeError: 'AILover' object has no attribute 'DECODING_MAP'
2025-10-04 23:28:47 - [INFO] - 正在加載核心 Cog (core_cog)...
2025-10-04 23:28:50 - [INFO] - ✅ 核心 Cog (core_cog) 已加載，並且所有持久化視圖已成功註冊。
2025-10-04 23:28:50 - [INFO] - ✅ 核心 Cog 加載成功。
2025-10-04 23:28:50 - [INFO] - 正在全域同步應用程式指令...
2025-10-04 23:28:50 - [INFO] - ✅ 指令已全域同步！
2025-10-04 23:28:50 - [INFO] - Discord Bot setup hook finished!
2025-10-04 23:28:53 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-10-04 23:28:53 - [INFO] - 已成功發送啟動成功通知給管理員。
2025-10-04 23:30:43 - [INFO] - 使用者 512280345618546699 沒有活躍的 AI 實例，嘗試創建...
2025-10-04 23:30:43 - [INFO] - 為使用者 512280345618546699 成功創建並初始化 AI 實例。
2025-10-04 23:30:43 - [INFO] - [512280345618546699] 核心數據模板 'world_snapshot_template.txt' 已成功加載。
2025-10-04 23:30:43 - [INFO] - [512280345618546699] 核心協議 '00_supreme_directive.txt' 已成功加載。
2025-10-04 23:30:43 - [INFO] - ✅ [Embedding Loader] 檢測到本地模型路徑，正在嘗試從 'D:\DINO\SD\ComfyUI\personal_server\ai_lover_service\models\stella-base-zh-v2' 加載...
2025-10-04 23:30:45 - [INFO] - ✅ [Embedding Loader] 本地 Embedding 模型實例創建成功。
2025-10-04 23:30:45 - [INFO] - [512280345618546699] 所有輕量級前置資源已準備就緒 (RAG 創建已延遲)。
2025-10-04 23:30:45 - [INFO] - [512280345618546699] (Retriever Builder) 檢測到現有 RAG 索引，正在加載...
2025-10-04 23:30:45 - [INFO] - [512280345618546699] [RAG持久化] 成功從磁碟加載了 34 條文檔到 RAG 語料庫。
2025-10-04 23:30:45 - [INFO] - [512280345618546699] (Retriever Builder) ✅ 混合檢索器已成功從持久化索引加載。
2025-10-04 23:30:45 - [INFO] - [512280345618546699] 正在從資料庫恢復短期場景記憶...
2025-10-04 23:30:45 - [INFO] - [512280345618546699] 成功恢復了 1 個場景的對話歷史，總計 3 條訊息。
2025-10-04 23:30:46 - [INFO] - [512280345618546699] 啟動 RAG 直通對話流程...
2025-10-04 23:30:46 - [INFO] - [512280345618546699] [Direct RAG] 啟動 LORE 優先的 RAG 直通生成流程...
2025-10-04 23:30:46 - [INFO] - [512280345618546699] [LORE 擴展] 正在檢查是否需要擴展 LORE...
2025-10-04 23:30:47 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:30:48 - [INFO] - [512280345618546699] [LORE 擴展] 無需擴展新的 LORE。
2025-10-04 23:30:48 - [INFO] - [512280345618546699] [實體名稱提取] 正在從查詢 '抓著碧，深喉嚨口交...' 中分析實體...
2025-10-04 23:30:48 - [INFO] - [512280345618546699] [輸入分析-L1] 正在嘗試使用 LLM 進行語義分析...
2025-10-04 23:30:48 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:30:48 - [INFO] - [512280345618546699] [輸入分析-L1] ✅ LLM 分析成功。提取實體: ['碧']
2025-10-04 23:30:48 - [INFO] - [512280345618546699] [實體名稱提取] 查詢分析完成，共識別出 2 個核心實體: ['DINO', '碧']。
2025-10-04 23:30:48 - [INFO] - [512280345618546699] [實體名稱提取] 正在從查詢 '抓著碧，深喉嚨口交...' 中分析實體...
2025-10-04 23:30:48 - [INFO] - [512280345618546699] [輸入分析-L1] 正在嘗試使用 LLM 進行語義分析...
2025-10-04 23:30:49 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:30:49 - [INFO] - [512280345618546699] [輸入分析-L1] ✅ LLM 分析成功。提取實體: ['碧']
2025-10-04 23:30:49 - [INFO] - [512280345618546699] [實體名稱提取] 查詢分析完成，共識別出 2 個核心實體: ['DINO', '碧']。
2025-10-04 23:30:49 - [INFO] - [512280345618546699] [RAG 原文直通] 查詢已擴展為: '抓著碧，深喉嚨口交 DINO 碧'
2025-10-04 23:30:50 - [INFO] - [512280345618546699] [RAG 原文直通] 粗略檢索成功，獲得 18 份候選文檔。
2025-10-04 23:30:50 - [INFO] - [512280345618546699] [RAG 原文直通] ✅ 成功拼接全部 18 條原始文檔作為 summary_context。
2025-10-04 23:30:52 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:31:26 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-pro' with API Key #0.
2025-10-04 23:31:27 - [INFO] - [512280345618546699] RAG 直通流程執行完畢，回應已發送。事後學習任務已在背景啟動。
2025-10-04 23:31:28 - [INFO] - [512280345618546699] [事後分析] 正在啟動背景分析與分流任務...
2025-10-04 23:31:30 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:31:30 - [INFO] - [512280345618546699] [長期記憶寫入] 正在保存預生成的安全摘要...
2025-10-04 23:31:31 - [INFO] - [512280345618546699] [長期記憶寫入] 互動記錄已成功保存到 SQL 資料庫。
2025-10-04 23:31:31 - [INFO] - [512280345618546699] [長期記憶寫入] 安全摘要保存完畢。
2025-10-04 23:31:33 - [INFO] - [512280345618546699] 背景任務：檢測到 1 條預生成LORE，準備執行...
2025-10-04 23:31:33 - [INFO] - --- [512280345618546699] (LORE Executor) 開始串行執行 1 個修正後的LORE任务 ---
2025-10-04 23:31:33 - [WARNING] - [512280345618546699] [抗幻覺] 檢測到對不存在實體 '未知實體' 的更新。啟動事實查核...
2025-10-04 23:31:34 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:31:34 - [WARNING] - [512280345618546699] 模型 'gemini-2.5-flash-lite' (Key #0) 遭遇解析或驗證錯誤: JSONDecodeError。啟動【自我修正】流程...
2025-10-04 23:31:34 - [WARNING] - [512280345618546699] 導致解析錯誤的原始 LLM 輸出: 
--- START RAW ---
```json
{
  "decision": "IGNORE",
  "reasoning": "對話上下文為空，且現有實體數據庫為空。無法從任何來源找到關於'未知實體'的資訊，因此不滿足創建、合併或忽略的任何條件。",
  "matched_key": null
}
```
--- END RAW ---
2025-10-04 23:31:34 - [INFO] - [512280345618546699] [LLM Success] Generation successful using model 'gemini-2.5-flash-lite' with API Key #0.
2025-10-04 23:31:34 - [INFO] - [512280345618546699] [自我修正] ✅ 修正流程成功，正在重新驗證...
2025-10-04 23:31:34 - [WARNING] - [512280345618546699] [抗幻覺] 事實查核裁定為 IGNORE。已跳過操作。理由: 對話上下文為空，且現有實體數據庫為空。無法從任何來源找到關於'未知實體'的資訊，因此不滿足創建、合併或忽略的任何條件。
2025-10-04 23:31:34 - [INFO] - --- [512280345618546699] (LORE Executor) LORE 扩展計畫执行完毕 ---
2025-10-04 23:31:34 - [INFO] - [512280345618546699] 背景任務：LORE更新執行完畢。摘要: LORE 扩展已执行。
2025-10-04 23:31:34 - [INFO] - [512280345618546699] [事後分析] 背景分析與分流任務完成。
2025-10-04 23:49:41 - [INFO] - 正在加載核心 Cog (core_cog)...
2025-10-04 23:49:44 - [INFO] - ✅ 核心 Cog (core_cog) 已加載，並且所有持久化視圖已成功註冊。
2025-10-04 23:49:44 - [INFO] - ✅ 核心 Cog 加載成功。
2025-10-04 23:49:44 - [INFO] - 正在全域同步應用程式指令...
2025-10-04 23:49:45 - [INFO] - ✅ 指令已全域同步！
2025-10-04 23:49:45 - [INFO] - Discord Bot setup hook finished!
2025-10-04 23:49:48 - [INFO] - Logged in as AI#4450 (ID: 1358417100250808531)
2025-10-04 23:49:48 - [INFO] - 已成功發送啟動成功通知給管理員。
